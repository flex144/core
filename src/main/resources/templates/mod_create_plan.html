<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Planvorlage erstellen</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.css">

    <div th:include="/fragments/navbar :: style_fragment"></div>

    <style>
        #inputUnit:disabled {
            background-color: white;
        }
        ul {
            list-style-type: none;
        }
        .bootstrap-tagsinput {
            width: 100% !important;
            border: none;
            box-shadow: none;
        }
        .bootstrap-tagsinput input {
            display: none;
        }
        .accordion {
            background-color: #e1e1e1;
            border-radius: 10px;
            color: #444;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 15px;
            transition: 0.4s;
        }
        .active {
            background-color: #ccc;
            border-radius: 10px 10px 0px 0px;
        }

        .accordion:hover {
            background-color: #ccc;
        }

        .accordion:after {
            content: '\002B';
            color: #777;
            font-weight: bold;
            float: right;
            margin-left: 5px;
        }

        .active:after {
            content: "\2212";
        }

        .accordionPanel {
            padding: 0 18px;
            background-color: white;
            border-radius: 0px 0px 10px 10px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
        }
        * {
            box-sizing: border-box;
        }
        .col-container {
            display: table;
            width: 100%;
        }
        .col {
            display: table-cell;
            padding: 5px;
            width: 33%;
        }
        @media only screen and (max-width: 600px) {
            .col {
                display: block;
                width: 100%;
            }
         }
    </style>
</head>

<body>
<div th:replace="/fragments/navbar :: navbar_mod"></div>

<div class="container">
    <form th:action="@{/mods/plans}" method="post" th:object="${createDto}">
    <!-- Jumbotron with information for the page and inputs for general data for the plan -->
        <div class="jumbotron">
            <h2>Erstelle eine neue Trainingsplanvorlage</h2>
            <br>
            <button class="accordion">Anleitung</button>
            <div class="accordionPanel">
                <br>
                <p style="font-size: 12pt">Gib zuerst die allgemeinen Daten zu deinem Plan an, die Bezeichnung, den Planfokus und die Anzahl
                    der Trainingseinheiten</p>
                <p style="font-size: 12pt">Um Übungen zu deinem Plan hinzuzufügen, fülle das Formular <mark>"Übung bearbeiten"</mark> aus
                    und klicke auf den Button <mark>"Übung hinzufügen"</mark>. Falls du eine noch nicht vorhandene Übung in deinem Plan verwenden willst,
                    drücke den Button <mark>"Neue Übungsart"</mark> um direkt eine Neue zu erstellen.</p>
                <p style="font-size: 12pt">
                    Um die Sätze und die Wiederholungen für eine Übung anzugeben, gib die Wiederholungen mit <mark>"/"</mark>
                    getrennt voneinander an und die Anzahl der Sätze für diese Übung wird daraus automatisch berechnet.<br>
                </p>
                <p class="text-muted" style="font-size: 12pt">
                    (Beispiel: Wiederholungen: <mark>12/12/13/15</mark> => <mark>4</mark> Sätze)
                </p>
                <p style="font-size: 12pt">Wenn du am Ende mit deinem Plan zufrieden bist,
                    speichere diesen mit einem Klick auf den Button <mark>"Plan speichern"</mark>.</p>
            </div>
            &ensp;
            <br>
            <!-- Input fields for general data of the plan -->
            <div class="row">
                <p th:if="${errorMsg}" th:text="${errorMsg}" style="color: red"></p>
            </div>
            <div class="col-container">
                <div class="col">
                    <div class="form-group">
                        <label for="planName">Planbezeichnung:</label>
                        <input  type="text" class="form-control" id="planName"
                                placeholder="Hier Bezeichnung eingeben..." th:field="*{planName}">
                    </div>
                </div>
                <div class="col">
                    <div class="form-group-inline">
                        <label for="focus">Trainingsfokus:</label>
                        <select id="focus" class="form-control" required th:field="*{trainingsFocus}">
                            <option th:value="null" selected disabled hidden>Wähle eine Option aus...</option>
                            <option th:value="muscle">Muskelaufbau</option>
                            <option th:value="stamina">Ausdauer</option>
                            <option th:value="pain">Schmerzreduktion</option>
                        </select>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="rmAmount">Repetition Maximum:</label>
                        <input  type="number" class="form-control" id="rmAmount"
                                placeholder="Hier Repetition Maximum eingeben..">
                    </div>
                </div>
            </div>
            <br>
            <div class="col-container">
                <div class="col">
                    <div class="form-group">
                        <label for="inputUnit">Trainingseinheiten: </label>
                        <button type="button" class="btn decrement-button" id="btnDecrementTEs"
                                onclick="decrementTEs(); updateTeInputs()">
                            <span class="glyphicon glyphicon-minus"></span>
                        </button>
                        <input type="text" name="trainingUnits" id="inputUnit" th:field="*{sessionNums}"
                               style="width: 30px; border: 3px solid darkgray; text-align: center;
                           font-weight: bold" readonly>
                        <button type="button" class="btn increment-button" id="btnIncrementTEs"
                                onclick="incrementTEs(); updateTeInputs()">
                            <span class="glyphicon glyphicon-plus"></span>
                        </button>
                        <input th:field="*{id}" style="width: 30px; border: 3px solid darkgray; text-align: center;
                           font-weight: bold" hidden>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="inputUnit">Trainingseinheiten pro Woche: </label>
                        <button type="button" class="btn decrement-button" id="btnDecrementWeeklyTes"
                                onclick="decrementWeeklyTEs()">
                            <span class="glyphicon glyphicon-minus"></span>
                        </button>
                        <input type="text" name="trainingUnits" id="inputUnitsPerWeek" style="width: 30px; border: 3px solid darkgray; text-align: center;
                           font-weight: bold" readonly value="1">
                        <button type="button" class="btn increment-button" id="btnIncrementWeeklyTes"
                                onclick="incrementWeeklyTEs()">
                            <span class="glyphicon glyphicon-plus"></span>
                        </button>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <div class="form-check">
                            <label class="form-check-label" for="singleDayCheck">
                                Eintagesplan:</label>
                            <input type="checkbox" class="form-check-input" id="singleDayCheck"
                                   onchange="checkboxChanged()" style="margin-left: 20px" th:field="*{oneShot}">
                            <input type="text" id="prevUnitAmount" value="3" hidden disabled>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- panel with form to customize an exercise, add it to the plan and create a new exercise -->
        <div class="panel panel-default outerPanel">
            <!-- Panel header with title and buttons to add or create exercises and to reset the form -->
            <div class="panel-heading">
                <div class="row">
                    <div class="col-md-6" style="margin-top: 6px">
                        Übung bearbeiten
                    </div>
                    <div class="col-md-2">
                        <button type="button" id="submitDelete" class="btn btn-danger btn-block">
                            <span class="glyphicon glyphicon-trash"></span>
                            Plan Löschen
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary btn-block" id="buttonAddExercise">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                            Übung hinzufügen
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button type="button" id="buttonResetModal" data-toggle="modal" data-target="#modalConfirmResetForm"
                                class="btn btn-warning btn-block">
                            <span class="glyphicon glyphicon-trash"></span>
                             Formular leeren
                        </button>
                    </div>
                    <!--
                    <div class="col-md-2">

                    </div>-->
                </div>
            </div>
            <!-- panel with form to customize and add an exercise to the plan -->
            <div class="panel-body">
                <div class="col-md-12">
                    <!-- table for input forms to customize an exercise -->
                    <table class="table table-bordered table-condensed" border="1" width="100%">
                        <colgroup>
                            <col width="5%">
                            <col width="15%">
                            <col width="30%">
                            <col width="5%">
                            <col width="25%">
                            <col width="5%">
                            <col width="5%">
                        </colgroup>
                        <thead>
                            <tr>
                                <th>Ordnung</th>
                                <th>Übung</th>
                                <th>Ausführung</th>
                                <th>TE</th>
                                <th>Wiederholungen</th>
                                <th>Tempo</th>
                                <th>Pause</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <input id="inputOrder" type="text" class="form-control" th:field="*{category}"/>
                                </td>
                                <td>
                                    <input id="inputExercise" type="text" class="form-control"
                                           list="storedExercises"
                                           name="exerciseName" required th:field="*{exerciseName}">
                                        <datalist id="storedExercises">
                                            <option th:each="exercise : ${allExercises}" th:value="${exercise.getName()}" th:text="${exercise.name}"/>
                                        </datalist>
                                    </input>
                                    <br>
                                    <button type="button" data-toggle="modal" id="buttonCreateExercise"
                                            class="btn btn-success btn-md launch-modal">
                                        <span class="glyphicon glyphicon-plus-sign"></span>
                                        Neue Übungsart
                                    </button>
                                </td>
                                <td>
                                    <div class="input-group">
                                        <input id="inputExecution" type="text" name="executions"
                                               class="form-control" list="storedExecutions" onchange="addTag()">
                                        <div class="input-group-btn">
                                            <button class="btn btn-success" id="buttonAddExecution"
                                                    onclick="addTag()">
                                                <span class="glyphicon glyphicon-plus"></span>
                                                Add
                                            </button>
                                        </div>
                                    </div>
                                    <datalist id="storedExecutions">
                                        <option th:each="tag : ${allTags}" th:value="${tag}"/>
                                    </datalist>
                                    </input>
                                    <br>
                                    <button type="button" data-toggle="modal" id="buttonNewExecution"
                                            class="btn btn-success btn-md"
                                            data-target="#modalExecutionForm">
                                        <span class="glyphicon glyphicon-plus-sign"></span>
                                        Neue Ausführung
                                    </button>
                                    <div id="tagBlock">
                                        <br>
                                        <h5 id="tagHeader">Hinzugefügte Ausführungen:</h5>
                                        <input type="text" data-role="tagsinput" id="tags" value=""
                                               class="form-control tagsPlanInput" name="tags">
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="counterTE" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="repsInputs" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="tempoInputs" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="pauseInputs" class="list-group" ></ul> <!-- todo only numeric input -->
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- panel with overview of final plan and button to save the plan -->
        <div class="panel panel-success outerPanel">
            <div class="panel-heading">
                Aktueller Trainingsplan
            </div>
            <div class="panel-body">
                <div class="col-md-12" th:if="${plan}">
                    <!-- Table to list the added exercises in the final plan -->
                    <table class="table table-bordered table-condensed" border="1" width="100%">
                        <colgroup>
                            <col width="5%">
                            <col width="85%">
                            <col width="10%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>Ordnung</th>
                            <th>Übung</th>
                            <th>Detailansicht</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="exercise : ${plan.exerciseInstances}">
                            <td th:text="${exercise.category}">
                                <div class="form-group">
                                    <ul id="planExerciseOrder" class="list-group"></ul>
                                </div>
                            </td>
                            <td th:text="${exercise.name}">
                                <div class="form-group">
                                    <ul id="planExerciseName" class="list-group"></ul>
                                </div>
                            </td>
                            <td>
                                <div class="form-group">
                                    <ul id="planButtonExerciseDetails" class="list-group">
                                        <button type="button"
                                                class="btn btn-success btn-block detailModal"
                                                th:onclick="'javascript:updateDetails(\'' + ${exercise.id} + '\')'">
                                            <span class="glyphicon glyphicon-plus-sign"></span>
                                            Details
                                        </button>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Buttons for preview of the plan and to save it -->
                <div class="row">
                    <div class="col-md-8"></div>
                    <div class="col-md-2">
                        <button type="button" id="previewPlan" class="btn btn-primary btn-block"
                                onclick="updateDetails('previewPlan')">
                            <span class="glyphicon glyphicon-blackboard"></span>
                            Planvorschau
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button type="button" id="savePlan" class="btn btn-success btn-block" onclick="resetPlan()">
                            <span class="glyphicon glyphicon-floppy-save"></span>
                            Plan speichern
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<!-- Modal with formular to create a new exercise -->
<div class="modal fade" id="modalExerciseForm">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title">Neue Trainingsübung erstellen</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="exerciseName">Name der Übung:</label>
                            <input type="text" class="form-control" id="exerciseName"
                                   placeholder="Hier die Übungsbezeichnung eingeben...">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="exercise_description">Beschreibung der Übung:</label>
                                <textarea id="exercise_description" class="form-control"
                                          rows="6"></textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="muscleImageInput">Muskelgruppen-Bild:</label>
                                <input type="image" class="form-control" id="muscleImageInput"
                                       placeholder="Hier Bild mit Muskelgruppen einfügen...">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="weightType">Gewichtsart auswählen</label>
                            <select id="weightType" class="form-control">
                                <option selected disabled hidden>Wähle eine Option aus...</option>
                                <option>Eigengewicht</option>
                                <option>Befestigtes Gewicht</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="videoLink1">Erklärungsvideos: (Optional)</label>
                            <input type="url" class="form-control" id="videoLink1"
                                   placeholder="Hier Link zu einem Erklärungsvideo einfügen...">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="imageInput">Zusätzliche Bilder hochladen (Optional)</label>
                            <input type="image" class="form-control" id="imageInput"
                                   placeholder="Hier Bild zur Übung einfügen...">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary">Speichern</button>
                <button type="button" class="btn btn-default" id="buttonCloseExerciseForm"
                        data-dismiss="modal">
                    Schließen
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal with formular to create a new type of execution -->
<div class="modal fade" id="modalExecutionForm">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Neue Ausführungsart erstellen</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputExecutionName">Bezeichnung der Ausführung:</label>
                    <input  type="text" class="form-control" id="inputExecutionName" autofocus
                            placeholder="Hier die Bezeichnung für die neue Ausführungsart eingeben...">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="createExecution()" data-dismiss="modal">
                    Speichern</button>
                <button type="button" class="btn btn-default" id="buttonCloseExecutionModal"
                        data-dismiss="modal">Schließen</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to confirm the reset of the exercise formular -->
<div class="modal fade" id="modalConfirmResetForm">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-warning">
                    <div class="panel-heading">
                        <h4>Zurücksetzen des Formulars bestätigen</h4>
                    </div>
                    <!-- Panel body with warning text and buttons to confirm/return -->
                    <div class="panel-body">
                        <p style="font-size: 16px">
                            Wollen sie das Eingabeformular wirklich zurücksetzen?
                        </p>
                        <p class="text-danger" style="font-size: 12px">
                            Nicht gespeichterte Daten werden verworfen!
                        </p>
                        <br>
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-warning btn-block"
                                        id="buttonResetFormular" onclick="resetForm()"
                                        data-dismiss="modal">
                                    Zurücksetzen
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block"
                                        data-dismiss="modal">
                                    Abbrechen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal to view the details of an example exercise -->
<!--
<div class="modal fade" id="modalDetailsExercise">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h4>Detailansicht</h4>
                    </div>
                    <!-- Panel body with an example exercise to show the detail view -->
                    <!--
                    <div class="panel-body" th:if="${plan}">
                        <div class="col-md-12">
                            <table class="table table-bordered table-condensed detailExerciseTable" border="1"
                                   width="100%" th:each="exercise : ${plan.exerciseInstances}">
                                <colgroup>
                                    <col width="5%">
                                    <col width="15%">
                                    <col width="30%">
                                    <col width="7%">
                                    <col width="23%">
                                    <col width="5%">
                                    <col width="5%">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>Ordnung</th>
                                    <th>Übung</th>
                                    <th>Ausführung</th>
                                    <th>TE</th>
                                    <th>Sätze - Wiederholungen</th>
                                    <th>Tempo</th>
                                    <th>Pause</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>
                                        <input id="viewOrder" type="text" class="form-control"
                                               th:value="${exercise.category}" disabled/>
                                    </td>
                                    <td>
                                        <input id="viewExercise" type="text" class="form-control"
                                               th:value="${exercise.name}" disabled/>
                                    </td>
                                    <td>
                                        <textarea id="viewDescription" class="form-control"
                                                  rows="4" disabled>Auf geraden Rücken achten!
                                        </textarea>
                                    </td>
                                    <td >
                                        <div class="form-group" th:each="sessions, iStat : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${iStat.count}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group">
                                                <nobr th:each="rep : ${sessions.reps}">
                                                    <nobr th:if="${rep} != 0" th:text="${rep} + ' /'"></nobr>
                                                </nobr>
                                            </ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.tempo}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.pauseInSec}"></ul>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Panel footer with Buttons to interact with the shown exercise -->
                    <!--
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-4">
                                <button type="button" class="btn btn-danger btn-block"
                                        id="deleteCurrentExercise" data-dismiss="modal">
                                    Übung löschen
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-block"
                                        id="editCurrentExercise" data-dismiss="modal">
                                    Übung bearbeiten
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block" id="btnCloseModalShowDetails"
                                        data-dismiss="modal">
                                    Schließen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                    -->
<!--
                </div>
            </div>
        </div>
    </div>
</div>
-->

<!-- Modal to view the details of an example plan -->
<div class="modal fade" id="modalViewFinalPlan">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-success" th:if="${plan}">
                    <!-- Panel header with title and general date for the final plan -->
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-md-3">
                                <h4 id="planOrExercise">Planvorschau</h4>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanName"
                                       th:value="${plan.name}" disabled/>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanFocus"
                                       th:value="${plan.trainingsFocus}" disabled/>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanTE"
                                       th:value="${plan.numTrainSessions}" disabled/>
                            </div>
                        </div>
                    </div>
                    <!-- Panel body containing 3 example exercises for an example plan -->
                    <div class="panel-body">
                        <div class="col-md-12">
                            <table class="table table-bordered table-condensed detail detailExerciseTable" border="1"
                                   width="100%" th:each="exercise : ${plan.exerciseInstances}"
                                   th:id="${exercise.id}">
                                <colgroup>
                                    <col width="5%">
                                    <col width="15%">
                                    <col width="30%">
                                    <col width="7%">
                                    <col width="23%">
                                    <col width="5%">
                                    <col width="5%">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>Ordnung</th>
                                    <th>Übung</th>
                                    <th>Ausführung</th>
                                    <th>TE</th>
                                    <th>Sätze - Wiederholungen</th>
                                    <th>Tempo</th>
                                    <th>Pause</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td th:text="${exercise.category}">
                                    </td>

                                    <td th:text="${exercise.name}">
                                    </td>
                                    <td>
                                        <nobr th:class="'planTagsClass' + ${exercise.id}"
                                              th:each="tag : ${exercise.tags}" th:data="${tag}">
                                        </nobr>
                                        <div id="tagBlockPlan">
                                            <input type="text" data-role="tagsinput"
                                                   th:id="'tagsPlan' + ${exercise.id}"
                                                   value="" class="form-control tagsPlanInput" disabled>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group"
                                             th:each="sessions, iStat : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${iStat.count}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group">
                                                <nobr th:each="rep : ${sessions.reps}">
                                                    <nobr th:if="${rep} != 0" th:text="${rep} + ' /'"></nobr>
                                                </nobr>
                                            </ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.tempo}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.pauseInSec}"></ul>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                    <!-- Panel footer with button to close the modal positioned on the right -->
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-4">
                                <button type="button" class="btn btn-danger btn-block"
                                        id="deleteCurrentExercise" data-dismiss="modal">
                                    Übung löschen
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-block"
                                        id="editCurrentExercise" data-dismiss="modal">
                                    Übung bearbeiten
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block" id="btnCloseModalViewPlan"
                                        data-dismiss="modal">
                                    Schließen
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<form th:action="@{/mods/plans/{path}(path=${createDto.getId()})}" th:method="delete" id="formDelete">
</form>

<!-- Modal to ask if the plan should be converted to a single day plan -->
<div class="modal fade" id="modalConvertPlan">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h4>Konvertieren des Plans zu einem Eintagesplan</h4>
                    </div>
                    <!-- Panel body the option to converted the plan to a single day plan -->
                    <div class="panel-body">
                        <!-- question if the plan should be converted to a single day plan -->
                        <p style="font-size: 16px">
                            Sie haben die Anzahl an Trainingseinheiten für diese Planvorlage auf 1 gesetzt.
                            Möchten sie die Planvorlage in eine Vorlage für einen Eintagesplan umwandeln?
                        </p>
                        <br>
                        <!-- Remark that the changes can be reverted at any time -->
                        <p class="text-muted" style="font-size: 16px">
                            Sie können diese Änderung jederzeit rückgängig machen, indem sie den Haken
                            bei dem Eintagesplan wieder entfernen.
                        </p>
                        <br>
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-block"
                                        id="buttonConvertPlanToSingleDay" onclick="convertPlanToSingleDay()"
                                        data-dismiss="modal">
                                    Umwandeln
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block" id="btnCloseModalConvertPlan"
                                        data-dismiss="modal">
                                    Abbrechen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    /**
     * Execute various functions when the page is loaded
     */
    $(document).ready(function(){
        // Open the modal to create a new exercise without the possibility
        // to close the modal by clicking outside of it or esc
        $('.launch-modal').click(function(){
            // launch the modalExerciseForm as static modal to avoid closing by accident
            $('#modalExerciseForm').modal({
                backdrop: 'static'
            });
        });
        // Execute function updateTeInputs when document is loaded
        updateTeInputs();
        // Hide the empty display block for the exercise execution tags
        document.getElementById("tagBlock").style.display = "none";
        document.getElementById("submitDelete").onclick = function() {
            document.getElementById("formDelete").submit();
        }
        // Call function to give functionality to the accordion block
        accordionJS();
    });

    function setPlanTags(value) {
        var x = document.getElementsByClassName("planTagsClass" + value);
        var i;
        for (i = 0; i < x.length; i++) {
            var e = x[i].getAttribute('data');
            $('#tagsPlan' + value).tagsinput('add', e);
        }
    }

    /**
     * Set tags in the tag-input field "tags" to the colorset "warning" (yellow)
     */
    $('.tagsPlanInput').tagsinput({
        tagClass: 'label label-warning'
    });


    /**
     * Script to show details of one exercise. The value specifies the id
     * of the exercise instance.
     */
    function updateDetails(value) {
        var x = document.getElementsByClassName("detailExerciseTable");
        var i;

        if (value === "previewPlan") {
            for (i = 0; i < x.length; i++) {
                var y = document.getElementById(x[i].id);
                y.style.display = "block";
            }
            setPlanTags(value);
            document.getElementById("planOrExercise").innerText = "Planvorschau";
            document.getElementById("editCurrentExercise").style.display = "none";
            document.getElementById("deleteCurrentExercise").style.display = "none";
        } else {
            for (i = 0; i < x.length; i++) {
                var y = document.getElementById(x[i].id);
                if (y.id === value) {
                    y.style.display = "block";
                } else {
                    y.style.display = "none";
                }
            }
            setPlanTags(value);
            document.getElementById("planOrExercise").innerText = "Übungsdetails";
            document.getElementById("editCurrentExercise").style.display = "block";
            document.getElementById("deleteCurrentExercise").style.display = "block";
        }
        $(document).ready(function () {
            $('#modalViewFinalPlan').modal({
                backdrop: 'static'
            });
        });
    }

    /**
     * Function to hide the div block containing the tag-input field "tags" if there are no tags in it
     */
    $('#tags').on('itemRemoved', function() {
        // Check if the tag-input field "tags" is empty
        if (document.getElementById("tags").value.length == 0) {
            // Hide div block containing tag-input field "tags"
            document.getElementById("tagBlock").style.display = "none";
        }
    });

    /**
     * Function to set the the initial focus on the input field "inputExecutionName" when
     * opening the modal "modalExecutionForm"
     */
    $('#modalExecutionForm').on('shown.bs.modal', function () {
        $('#inputExecutionName').focus();
    });

    /**
     * Function to add a new Tag to the tag-input field "tags"
     */
    function addTag() {
        // Get the name of the new tag from the input field "inputExecution"
        var newTag = document.getElementById("inputExecution").value;
        // Add the stored tag to the tag-input field "tags"
        $('#tags').tagsinput('add', newTag);
        // Reset the input field "inputExecution"
        $('#inputExecution').val('');
        // Show the block containing the tag-input field and the caption
        document.getElementById("tagBlock").style.display = "block";
    }

    /**
     * Function to create a new type of execution to choose from in the datalist "storedExecutions"
     */
    function createExecution() {
        // Get the name of the new execution from the input field "inputExecutionName"
        var newExecution = document.getElementById("inputExecutionName").value;
        // Create a new option with the stored execution name in the datalist "storedEcexutions
        $('#storedExecutions').append(
            '<option value="'+newExecution+'" />'
        );
        // Reset the input field
        $('#inputExecutionName').val('');
    }

    /**
     * Function to add functionality to each accordion block
     */
    function accordionJS() {
        // Get all accordion blocks
        var accordion = document.getElementsByClassName("accordion");
        // Loop to add event-listener to each accordion
        for (var i = 0; i < accordion.length; i++) {
            // Add event-listener for click to current accordion
            accordion[i].addEventListener("click", function() {
                // Toggle the accordion if clicked
                this.classList.toggle("active");
                // Get following accodion-panel
                var accordionPanel = this.nextElementSibling;
                // Avoid overlap of accordion-panels
                if (accordionPanel.style.maxHeight){
                    accordionPanel.style.maxHeight = null;
                } else {
                    accordionPanel.style.maxHeight = accordionPanel.scrollHeight + "px";
                }
            });
        }
    }

    /**
     * Function to add an exercise to the final plan. After adding the exercise it calls
     * the function resetForm() to reset the input fields and calls the function checkPlanEmpty().
     */
    function addExerciseToPlan(){
        // Get the entered values of the exercise form
        var newExerciseOrder = $('#inputOrder').val();
        var newExerciseName = $('#inputExercise').val();
        // Create new list element in final plan containing the entered values and a button to view details
        $('#planExerciseOrder').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<input type="text" value="'+newExerciseOrder+'" class="form-control" disabled>' + '</li>');
        $('#planExerciseName').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<input type="text" value="'+newExerciseName+'" class="form-control" disabled>' + '</li>');
        $('#planButtonExerciseDetails').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<button type="button" class="btn btn-primary btn-block" data-toggle="modal" ' +
            'data-target="#modalDetailsExercise" onclick="getExerciseDetails()">' +
            '<span class="glyphicon glyphicon-zoom-in"></span>' + ' Details' + '</button>' + '</li>');
        // Reset the exercise form after adding the contents to the final plan
        resetForm();
        // Call checkPlanEmpty to disable the TE buttons after adding an element with fixed TE
        checkPlanEmpty();
    }

    /**
     * Temporary function to delete all elements in the final plan
     * and call the function checkPlanEmpty() to the button savePlan
     */
    function resetPlan() {
        // Create a reference on the lists in the final plan
        var addedOrders = document.getElementById("planExerciseOrder");
        var addedExercises = document.getElementById("planExerciseName");
        var addedDetailButtons = document.getElementById("planButtonExerciseDetails");
        // Remove all list elements in the final plan
        while (addedOrders.hasChildNodes()) {
            addedOrders.removeChild(addedOrders.lastChild);
        }
        while (addedExercises.hasChildNodes()) {
            addedExercises.removeChild(addedExercises.lastChild);
        }
        while (addedDetailButtons.hasChildNodes()) {
            addedDetailButtons.removeChild(addedDetailButtons.lastChild);
        }
        // call checkPlanEmpty to reset the TE buttons
        checkPlanEmpty()
    }


    /**
     * TODO verhindert dass pause und tempo leer bleiben.
     *
     * Function to be executed when the checkbox for a single day plan is checked.
     * It sets the TE to 1 and disables the TE-buttons
     */
    function checkboxChanged() {
        if($('#singleDayCheck').prop('checked')) {
            // Store the previous amount of TE´s in a hidden input field
            $('#prevUnitAmount').val(document.getElementById("inputUnit").value);
            // Set TE amount to 1
            $('#inputUnit').val(1);
            // Update the input fields according to the new TE amount
            updateTeInputs();
            // Disable the TE-buttons
            $('#btnDecrement').prop('disabled', true);
            $('#btnIncrement').prop('disabled', true);
        } else {
            // Set TE amount to the previous value before setting it to 1
            $('#inputUnit').val(document.getElementById("prevUnitAmount").value);
            // Update the input fields according to the new TE amount
            updateTeInputs();
            // Enable the TE-buttons
            $('#btnDecrement').prop('disabled', false);
            $('#btnIncrement').prop('disabled', false);
        }
    }

    /**
     * Function to check the checkbox for a single day if the user confirms the conversion
     * of the plan in the responsible modal
     */
    function convertPlanToSingleDay() {
        // Set the checked value of the checkbox to true
        $("#singleDayCheck").prop("checked", true);
        // Execute the function checkboxChanged to perform the action associated with the checkbox
        checkboxChanged();
    }

    /**
     * Deletes current input fields in the exercise form and creates new fields according to
     * the amount of entered TE´s
     */
    function updateTeInputs() {
        // Get the amount of TE´s
        var number = document.getElementById("inputUnit").value;

        // Get data lists and store them in variables for further manipulation
        var te = document.getElementById("counterTE");
        var reps = document.getElementById("repsInputs");
        var tempos = document.getElementById("tempoInputs");
        var pauses = document.getElementById("pauseInputs");

        // loops to reset the list with input fields in the exercise form
        while (te.hasChildNodes()) {
            te.removeChild(te.lastChild);
        }
        while (reps.hasChildNodes()) {
            reps.removeChild(reps.lastChild);
        }
        while (tempos.hasChildNodes()) {
            tempos.removeChild(tempos.lastChild);
        }
        while (pauses.hasChildNodes()) {
            pauses.removeChild(pauses.lastChild);
        }

        // loop to add example input fields to the TE/Repeats/Tempo/Pause columns in the exercise form
        for (var i=0;i<number;i++){
            // create unique id´s
            var counterTEId = "counter" + i;
            var repsInputId = "repsInput" + i;
            var tempoInputId = "tempoInput" + i;
            var pauseInputId = "pauseInput" + i;

            // Add the input fields to the lists
            $('#counterTE').append(
                '<li>' + '<input id="'+counterTEId+'" disabled value="'+(i+1)+'" class="form-control">' + '</li>');
            $('#repsInputs').append(
                '<li>' + '<input id="'+repsInputId+'" name="sets" type="text" class="form-control">' + '</li>');
            $('#tempoInputs').append(
                '<li>' + '<input id="' + tempoInputId + '" name="tempo" type="text" class="form-control">' + '</li>');
            $('#pauseInputs').append(
                '<li>' + '<input id="' + pauseInputId + '" name="pause" type="text" class="form-control">' + '</li>');
        }
    }

    /**
     * Function to check if the final plan contains exercises.
     * If yes: disable the buttons to change the TE-amount
     * If not: enable the buttons to change the TE-amount
     */
    function checkPlanEmpty() {
        // Get amount of TE´s
        var addedExercises = document.getElementById("planExerciseName");
        // Check if the final plan has contains exercises
        if (addedExercises.hasChildNodes()) {
            // Disable the TE buttons
            $('#btnDecrement').prop('disabled', true);
            $('#btnIncrement').prop('disabled', true);
            // Disable the single day checkbox
            $('#singleDayCheck').prop('disabled', true);
        } else {
            // Enable the TE buttons
            $('#btnDecrement').prop('disabled', false);
            $('#btnIncrement').prop('disabled', false);
            // Enable the single day checkbox
            $('#singleDayCheck').prop('disabled', false)
        }
    }

    /**
     * Function to reset the input form for an exercise to add to the plan
     */
    function resetForm() {
        // Get amount of TE´s
        var number = document.getElementById("inputUnit").value;
        // Empty the content of the input fields
        $('#inputOrder').val('');
        $('#inputExercise').val('');
        $('#inputDescription').val('');

        // Loop to empty the dynamically created input fields
        for (var i=0;i<number;i++){
            var currentRepsInput = "#repsInput" + i;
            var currentTempoInput = "#tempoInput" + i;
            var currentPauseInput = "#pauseInput" + i;
            $(currentRepsInput).val('');
            $(currentTempoInput).val('');
            $(currentPauseInput).val('');
        }

        $('#tags').tagsinput('removeAll');
        document.getElementById("tagBlock").style.display = "none";
    }

    /**
     * Function to increase the TE-counter and alert if TE climbs over 15
     */
    function incrementTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnit").value;
        // Test if the top limit is reached
        if (oldValue < 15) {
            // Increase the value by 1
            var newValue = parseFloat(oldValue) + 1;
        } else {
            // Alert to inform the user that the top limit is reached
            alert("Ein Trainingsplan kann nicht aus mehr als 15 Trainingseinheiten bestehen");
            var newValue = 15;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnit").value = newValue;
    }

    /**
     * Function to decrease the TE-counter and alert if TE falls under 3
     */
    function decrementTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnit").value;
        // Test if the bottom limit is reached
        if (oldValue > 1) {
            // Decrease the value by 1
            var newValue = parseFloat(oldValue) - 1;
            // Check if the TE amount has been reduced to 1
            if (newValue == 1) {
                // Open modal to ask if the editor wants to convert the plan to a single day plan
                $('#modalConvertPlan').modal({});
            }
        } else {
            // Alert to inform the user that the bottom limit is reached
            alert("Ein Trainingsplan kann nicht aus weniger als einer Trainingseinheit bestehen");
            var newValue = 1;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnit").value = newValue;
    }

    /**
     * Function to increase the amount of TEs per week and alert if amount climbs over 7
     */
    function incrementWeeklyTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnitsPerWeek").value;
        // Test if the top limit is reached
        if (oldValue < 7) {
            // Increase the value by 1
            var newValue = parseFloat(oldValue) + 1;
        } else {
            // Alert to inform the user that the top limit is reached
            alert("Ein Trainingsplan kann nicht mehr Trainigseinheiten pro Woche haben als die Woche Tage hat");
            var newValue = 7;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnitsPerWeek").value = newValue;
    }

    /**
     * Function to decrease the amount of TEs per week and alert if amount decreases below 1
     */
    function decrementWeeklyTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnitsPerWeek").value;
        // Test if the bottom limit is reached
        if (oldValue > 1) {
            // Decrease the value by 1
            var newValue = parseFloat(oldValue) - 1;
        } else {
            // Alert to inform the user that the bottom limit is reached
            alert("Ein Trainingsplan ist nicht regelmäßig, wenn er weniger als eine Trainingseinheit pro Woche vorsieht");
            var newValue = 1;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnitsPerWeek").value = newValue;
    }

    /**
     * Temporary function to add example-content to modal to view exercise details
     */
    function getExerciseDetails() {
        // Get amount of TE´s
        var number = document.getElementById("inputUnit").value;

        // Get data lists and store them in variables for further manipulation
        var te = document.getElementById("viewCounterTE");
        var reps = document.getElementById("viewRepsInputs");
        var tempos = document.getElementById("viewTempoInputs");
        var pauses = document.getElementById("viewPauseInputs");

        // loops to reset the example data in the viewExercise table
        while (te.hasChildNodes()) {
            te.removeChild(te.lastChild);
        }
        while (reps.hasChildNodes()) {
            reps.removeChild(reps.lastChild);
        }
        while (tempos.hasChildNodes()) {
            tempos.removeChild(tempos.lastChild);
        }
        while (pauses.hasChildNodes()) {
            pauses.removeChild(pauses.lastChild);
        }

        // loop to add example values to the TE/Repeats/Tempo/Pause columns in viewExercise table
        for (var i=0;i<number;i++){
            // create unique id´s
            var counterTEId = "viewCounter" + i;
            var repsInputId = "viewRepsInput" + i;
            var tempoInputId = "viewTempoInput" + i;
            var pauseInputId = "viewPauseInput" + i;

            // Add the examples to the lists
            $('#viewCounterTE').append(
                '<li>' + '<input id="'+counterTEId+'" disabled value="'+(i+1)+'" class="form-control">' + '</li>');
            $('#viewRepsInputs').append(
                '<li>' + '<input id="'+repsInputId+'" disabled value="3 - '+(10+i)+'" type="text" class="form-control">' + '</li>');
            $('#viewTempoInputs').append(
                '<li>' + '<input id="'+tempoInputId+'" disabled value="90" type="text" class="form-control">' + '</li>');
            $('#viewPauseInputs').append(
                '<li>' + '<input id="'+pauseInputId+'" disabled value="60" type="text" class="form-control">' + '</li>');
        }
    }
</script>

</body>
</html>