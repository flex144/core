<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Planvorlage erstellen</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.css">

    <div th:include="/fragments/navbar :: style_fragment"></div>

    <style>
        #inputUnitsPerWeek,
        #inputUnit {
            width: 40px;
            text-align: center;
            font-weight: bold;
            background-color: white;
            color: black;
        }
        #inputFieldCheckbox {
            width: 42px;
            padding: 0px;
            text-align: center;
        }
        #singleDayCheck {
            margin-top: 7px;
        }
        ul {
            list-style-type: none;
        }
        .bootstrap-tagsinput {
            width: 100% !important;
            border: none;
            box-shadow: none;
        }
        .bootstrap-tagsinput input {
            display: none;
        }
        .accordion {
            background-color: #e1e1e1;
            border-radius: 10px;
            border: none;
            color: #444;
            cursor: pointer;
            padding: 18px;
            width: 100%;
            text-align: left;
            outline: none;
            font-size: 15px;
            font-weight: bold;
            transition: 0.4s;
        }
        .active {
            background-color: #ccc;
            border-radius: 4px 4px 0px 0px;
        }

        .accordion:hover {
            background-color: #ccc;
        }

        .accordion:after {
            content: '\002B';
            color: #777;
            font-weight: bold;
            float: right;
            margin-left: 5px;
        }

        .active:after {
            content: "\2212";
        }

        .accordionPanel {
            padding: 0 18px;
            background-color: white;
            border-radius: 0px 0px 4px 4px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
        }
        * {
            box-sizing: border-box;
        }
        .col-container {
            display: table;
            width: 100%;
        }
        .col {
            display: table-cell;
            padding: 5px;
        }
        .col-general {
            width: 50%;
        }
        .col-exercise {
            width: 28%;
        }
        .col-button {
            width: 16%;
        }
        .col-execution {
            width: 42%;
        }
        @media only screen and (max-width: 600px) {
            .col {
                display: block;
                width: 100%;
            }
         }
        .input-group .input-group-addon {
            font-weight: bold;
        }
        .input-group-general .input-group-addon {
            background-color: #e1e1e1;
        }
        .panel .panel-heading {
            font-weight: bold;
        }
        thead {
            background-color: #EEEEEE;
        }
    </style>
    <script type="text/javascript">
        function noenter() {
            return !(window.event && window.event.keyCode == 13); }
    </script>
</head>

<body>
<div th:replace="/fragments/navbar :: navbar_mod"></div>

<div class="container">
    <form th:action="@{/mods/plans}" method="post" th:object="${createDto}" id="createForm">
    <!-- Jumbotron with information for the page and inputs for general data for the plan -->
        <div class="jumbotron">
            <h2>Erstelle eine neue Trainingsplanvorlage</h2>
            <br>
            <button class="accordion" type="button">Anleitung</button>
            <div class="accordionPanel">
                <br>
                <p style="font-size: 12pt">Gib zuerst die allgemeinen Daten zu deinem Plan an: die Bezeichnung, den Planfokus,
                    die Zielgruppe, die Anzahl der Trainingseinheiten und die Anzahl der Trainingstage pro Woche.</p>
                <p style="font-size: 12pt">Zusätzlich kannst du angeben, ob der Plan ein Eintagesplan werden soll. Hier wird
                    die Anzahl der Trainingseinheiten auf 1 gesetzt.</p>
                <p style="font-size: 12pt">Um Übungen zu deinem Plan hinzuzufügen, fülle das Formular <mark>"Übung bearbeiten"</mark> aus
                    und klicke auf den Button <mark>"Übung hinzufügen"</mark>. Falls du eine noch nicht vorhandene Übung in deinem Plan verwenden willst,
                    drücke den Button <mark>"Neue Übungsart"</mark> um direkt eine Neue zu erstellen.</p>
                <p style="font-size: 12pt">
                    Um eine Gewichtsänderung für Sätze anzugeben, gibst du "+" / "-" der prozentualen Änderung des Repetition Maximum
                    in das Feld <mark>"Gewichtsänderungen"</mark> neben den entsprechenden Wiederholungen ein; es wird kein
                    "%"-Zeichen benötigt. Lässt du das Feld leer, werden keine Änderungen vorgenommen. <br>
                    Wenn du für mehrere Sätze eine unterschiedliche Gewichtsänderung eingeben möchtest, gib die Änderungen
                    mit <mark>"/"</mark> getrennt voneinandern ein. Hier muss die Anzahl der Änderungen
                    mit der Anzahl der Sätze übereinstimmen. <br>
                    Bei Übungen die das Eigengewicht verwenden wird das Feld Repetition Maximum ignoriert.
                    Gewichtsänderungen können dennoch angegeben werden und werden dem Nutzer dann in direkter Form angezeigt.
                </p>
                <p class="text-muted" style="font-size: 12pt">
                    (Beispiel: Gewichtsänderung: <mark>"+10"</mark> => Bei allen Sätzen steigert sich das Gewicht um 10 %. <br>
                    Gewichtsänderung: <mark>"+10/+10/+20"</mark> => Bei den ersten beiden Sätzen steigert sich das Gewicht um 10%,
                    beim dritten um 20%.)
                </p>
                <p style="font-size: 12pt">
                    Um die Sätze und die Wiederholungen für eine Übung anzugeben, gib die Wiederholungen mit <mark>"/"</mark>
                    getrennt voneinander an und die Anzahl der Sätze für diese Übung wird daraus automatisch berechnet.<br>
                </p>
                <p class="text-muted" style="font-size: 12pt">
                    (Beispiel: Wiederholungen: <mark>12/12/13/15</mark> => <mark>4</mark> Sätze)
                </p>
                <p style="font-size: 12pt">Wenn du am Ende mit deinem Plan zufrieden bist,
                    kannst du dir einzelne Übungen in der Detail-Ansicht, und den ganzen Plan unter
                    <mark>"Planvorschau"</mark> nochmals ansehen. Speichere deinen Plan mit einem Klick auf den Button
                    <mark>"Plan speichern"</mark>.</p>
            </div>
            &ensp;
            <br>
            <!-- Input fields for general data of the plan -->
            <div class="row">
                <p th:if="${errorMsg}" th:text="${errorMsg}" style="color: red"></p>
            </div>
            <div class="row" id="errorConfirm" style="display: none">
                <p style="color: red">Ein leerer Plan kann nicht gespeichert werden!</p>
            </div>
            <div class="col-container">
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon">Planbezeichnung:</span>
                        <input  type="text" class="form-control" id="planName" onkeypress="return noenter()"
                                placeholder="Hier Bezeichnung eingeben..." th:field="*{planName}">
                    </div>
                </div>
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon">Trainingsfokus:</span>
                        <select id="focus" class="form-control" required th:field="*{trainingsFocus}">
                            <option th:value="null" selected>Wähle eine Option aus...</option>
                            <option th:each="focus : ${T(de.ep.team2.core.enums.TrainingsFocus).values()}" th:value="${focus.getConst()}" th:text="${focus.toString()}"></option>
                        </select>
                    </div>
                </div>
            </div>
            <br>
            <div class="col-container">
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon">Zielgruppe:</span>
                        <select id="targetGroup" class="form-control" required th:field="*{targetGroup}">
                            <option th:value="null" selected>Wähle eine Gruppe aus...</option>
                            <option th:each="level : ${T(de.ep.team2.core.enums.ExperienceLevel).values()}" th:value="${level.getConst()}" th:text="${level.toString()}"></option>
                        </select>
                    </div>
                </div>
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon">Eintagesplan:</span>
                        <!-- replace padding & padding left with padding: auto for other screens than alex´ laptop -->
                        <a class="form-control" type="input" id="inputFieldCheckbox">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" onchange="checkboxChanged()" onkeypress="return noenter()"
                                       id="singleDayCheck" th:field="*{oneShot}" th:disabled="${plan}">
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <br>
            <div class="col-container">
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon" style="width: auto">Trainingseinheiten:</span>
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default" id="btnDecrementTEs"
                                        onclick="decrementTEs();" style="border-radius: 0px" th:disabled="${plan}">
                                    <span class="glyphicon glyphicon-minus"></span>
                                </button>
                            </div>
                            <input type="text" name="trainingUnits" class="form-control" id="inputUnit"
                                   onkeypress="return noenter()" th:field="*{sessionNums}" readonly>
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default" id="btnIncrementTEs"
                                        onclick="incrementTEs();" th:disabled="${plan}">
                                    <span class="glyphicon glyphicon-plus"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col col-general">
                    <div class="input-group input-group-general">
                        <span class="input-group-addon" style="width: auto">Trainingstage pro Woche:</span>
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default" id="btnDecrementWeeklyTes"
                                        onclick="decrementWeeklyTEs()" style="border-radius: 0px">
                                    <span class="glyphicon glyphicon-minus"></span>
                                </button>
                            </div>
                            <input type="text" name="trainingUnitsPerWeek" class="form-control" id="inputUnitsPerWeek" onkeypress="return noenter()"
                                   align="center" readonly th:field="*{recomSessionsPerWeek}">
                            <div class="input-group-btn">
                                <button type="button" class="btn btn-default" id="btnIncrementWeeklyTes"
                                        onclick="incrementWeeklyTEs()" style="border-radius: 0px 4px 4px 0px">
                                    <span class="glyphicon glyphicon-plus"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <input th:field="*{id}" hidden onkeypress="return noenter()" id="planID">
            <input type="text" id="prevUnitAmount" value="3" hidden disabled onkeypress="return noenter()">
        </div>

        <!-- panel with form to customize an exercise, add it to the plan and create a new exercise -->
        <div class="panel panel-default outerPanel">
            <!-- Panel header with title and buttons to add or create exercises and to reset the form -->
            <div class="panel-heading">
                <div class="row">
                    <div class="col-md-8" style="margin-top: 6px">
                        Übung bearbeiten
                    </div>
                    <div class="col-md-2">
                        <a type="button" class="btn btn-block btn-danger" data-toggle="modal"
                           data-target="#confirm_delete" th:if="${createDto.id != null}">
                            <span class="glyphicon glyphicon-remove"></span>
                            Plan Löschen
                        </a>
                    </div>
                    <div class="col-md-2">
                        <button type="button" id="buttonResetModal" data-toggle="modal" data-target="#modalConfirmResetForm"
                                class="btn btn-warning btn-block">
                            <span class="glyphicon glyphicon-trash"></span>
                             Formular leeren
                        </button>
                    </div>
                    <!--
                    <div class="col-md-2">

                    </div>-->
                </div>
            </div>
            <!-- panel with form to customize and add an exercise to the plan -->
            <div class="panel-body">
                <div class="col-container">
                    <div class="col col-button">
                        <button type="button" data-toggle="modal" id="buttonCreateExercise"
                                class="btn btn-success btn-block launch-modal">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                            Neue Übungsart
                        </button>
                    </div>
                    <div class="col col-exercise">
                        <div class="input-group">
                            <span class="input-group-addon">Übung:</span>
                            <input id="inputExercise" type="text" class="form-control" onkeypress="return noenter()"
                                   list="storedExercises" placeholder="Übung auswählen.."
                                   name="exerciseName" required th:field="*{exerciseName}">
                            <datalist id="storedExercises">
                                <option th:each="exercise : ${allExercises}" th:value="${exercise.getName()}" th:text="${exercise.name}"/>
                            </datalist>
                            </input>
                        </div>
                    </div>
                    <div class="col col-exercise">
                        <div class="input-group">
                            <span class="input-group-addon">Ordnung:</span>
                            <input  type="text" class="form-control" id="inputOrder" onkeypress="return noenter()"
                                    placeholder="Hier Ordnung eingeben.." th:field="*{category}">
                        </div>
                    </div>
                    <div class="col col-exercise">
                        <div class="input-group">
                            <span class="input-group-addon">RM:</span>
                            <input th:field="*{repetitionMaximum}" type="text" class="form-control" id="inputRM" onkeypress="return noenter()"
                                    placeholder="Hier repetition Maximum eingeben..">
                        </div>
                    </div>
                </div>
                <div class="col-container">
                    <div class="col col-button">
                        <button type="button" data-toggle="modal" id="buttonNewExecution"
                                class="btn btn-success btn-block"
                                data-target="#modalExecutionForm">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                            Neue Ausführung
                        </button>
                    </div>
                    <div class="col col-execution">
                        <div class="input-group">
                            <span class="input-group-addon">Ausführung(en):</span>
                            <input id="inputExecution" type="text" name="executions" onkeypress="return noenter()"
                                   class="form-control" list="storedExecutions">
                            <div class="input-group-btn">
                                <button class="btn btn-success" id="buttonAddExecution"
                                        onclick="checkExecution()" style="border-radius: 0px 4px 4px 0px" type="button">
                                    <span class="glyphicon glyphicon-plus"></span>
                                    Add
                                </button>
                            </div>
                            <datalist id="storedExecutions">
                                <option th:each="tag : ${allTags}" th:value="${tag}"/>
                            </datalist>
                            </input>
                        </div>
                    </div>
                    <div class="col col-execution">
                        <div id="tagBlock">
                            <div class="input-group">
                                <span class="input-group-addon">Hinzugefügte Ausführungen:</span>
                                <a class="form-control" type="input" style="height: auto; padding: 0px"
                                    placeholder=" ">
                                    <input type="text" data-role="tagsinput" id="tags" value="" name="tags" onkeypress="return noenter()"
                                           class="form-control tagsPlanInput">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <div class="col-md-12">
                    <!-- table for input forms to customize an exercise -->
                    <table class="table table-bordered table-condensed" border="1" width="100%">
                        <colgroup>
                            <col width="5%">
                            <col width="32.5%">
                            <col width="32.5%">
                            <col width="15%">
                            <col width="15%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>TE</th>
                            <th>Gewichtsänderungen</th>
                            <th>Wiederholungen</th>
                            <th>Tempo</th>
                            <th>Pause</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="form-group">
                                        <ul id="counterTE" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="weightsInputs" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="repsInputs" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="tempoInputs" class="list-group"></ul>
                                    </div>
                                </td>
                                <td>
                                    <div class="form-group">
                                        <ul id="pauseInputs" class="list-group" ></ul>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel-footer">
                <div class="row">
                    <div class="col-md-9"></div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-success btn-block" id="buttonAddExercise" onclick="checkExercise()">
                            <span class="glyphicon glyphicon-plus"></span>
                            Übung zum Plan hinzufügen
                        </button>
                        <div hidden>
                            <button type="submit" id="buttonAddExerciseClick">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
        <!-- panel with overview of final plan and button to save the plan -->
    <form th:action="@{/mods/confirmPlan}" method="post" th:object="${createDto}" id="confirmPlan">
        <div class="panel panel-success outerPanel">
            <div class="panel-heading">
                Aktueller Trainingsplan
            </div>
            <input th:field="*{id}" hidden>
            <div class="panel-body">
                <div class="col-md-12" th:if="${plan}">
                    <!-- Table to list the added exercises in the final plan -->
                    <table class="table table-bordered table-condensed" border="1" width="100%"
                           id="detailsExercises">
                        <colgroup>
                            <col width="5%">
                            <col width="85%">
                            <col width="10%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>Ordnung</th>
                            <th>Übung</th>
                            <th>Detailansicht</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="exercise : ${plan.exerciseInstances}">
                            <td th:text="${exercise.category}">
                                <div class="form-group">
                                    <ul id="planExerciseOrder" class="list-group"></ul>
                                </div>
                            </td>
                            <td th:text="${exercise.name}">
                                <div class="form-group">
                                    <ul id="planExerciseName" class="list-group"></ul>
                                </div>
                            </td>
                            <td>
                                <div class="form-group">
                                    <ul id="planButtonExerciseDetails" class="list-group">
                                        <button type="button"
                                                class="btn btn-success btn-block detailModal"
                                                th:onclick="'javascript:updateDetails(\'' + ${exercise.id} + '\')'">
                                            <span class="glyphicon glyphicon-plus-sign"></span>
                                            Details
                                        </button>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="panel-footer">
                <!-- Buttons for preview of the plan and to save it -->
                <div class="row">
                    <div class="col-md-8"></div>
                    <div class="col-md-2">
                        <button type="button" id="previewPlan" class="btn btn-primary btn-block"
                                onclick="updateDetails('previewPlan')">
                            <span class="glyphicon glyphicon-blackboard"></span>
                            Planvorschau
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button type="button" id="savePlan" class="btn btn-success btn-block" onclick="checkPlan()">
                            <span class="glyphicon glyphicon-floppy-save"></span>
                            Plan speichern
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<!-- Modal with formular to create a new exercise -->
<div class="modal fade" id="modalExerciseForm">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-warning">
                    <div class="panel-heading">
                        <h4>Verlassen der Seite bestätigen</h4>
                    </div>
                    <!-- Panel body with warning text and buttons to confirm/return -->
                    <div class="panel-body">
                        <p>
                            Um eine neue Übung zu erstellen wird die aktuelle Seite verlassen.
                        </p>
                        <p class="text-danger" style="font-size: 12px">
                            Nicht gespeichterte Eingaben in dem Formular zur Übungsbearbeitung werden verworfen!
                        </p>
                        <p>
                            Der angefangene Plan wird gespeichert, aber noch nicht freigegeben. <br>
                            Du kannst nach der Erstellung einer neuen Übung über die Plansuche deinen unfertigen
                            Plan finden, auswählen und ihn dann weiter bearbeiten. Alle bisher hinzugefügten Übungen
                            bleiben erhalten!
                        </p>
                        <br>
                    </div>
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <a type="button" class="btn btn-warning btn-block"
                                        th:href="@{/mods/createexercise}">
                                    Seite verlassen
                                </a>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block"
                                        data-dismiss="modal">
                                    Abbrechen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal with formular to create a new type of execution -->
<div class="modal fade" id="modalExecutionForm">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Neue Ausführungsart erstellen</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="inputExecutionName">Bezeichnung der Ausführung:</label>
                    <input  type="text" class="form-control" id="inputExecutionName" autofocus onkeypress="return noenter()"
                            placeholder="Hier die Bezeichnung für die neue Ausführungsart eingeben...">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="checkExecutionAdd()" data-dismiss="modal" id="saveNewExecution" >
                    Speichern</button>
                <button type="button" class="btn btn-default" id="buttonCloseExecutionModal"
                        data-dismiss="modal">Schließen</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to confirm the reset of the exercise formular -->
<div class="modal fade" id="modalConfirmResetForm">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-warning">
                    <div class="panel-heading">
                        <h4>Zurücksetzen des Formulars bestätigen</h4>
                    </div>
                    <!-- Panel body with warning text and buttons to confirm/return -->
                    <div class="panel-body">
                        <p style="font-size: 16px">
                            Wollen sie das Eingabeformular wirklich zurücksetzen?
                        </p>
                        <p class="text-danger" style="font-size: 12px">
                            Nicht gespeichterte Daten werden verworfen!
                        </p>
                        <br>
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-warning btn-block"
                                        id="buttonResetFormular" onclick="resetForm()"
                                        data-dismiss="modal">
                                    Zurücksetzen
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block"
                                        data-dismiss="modal">
                                    Abbrechen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal to view the details of an example plan -->
<div class="modal fade" id="modalViewFinalPlan">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-success" th:if="${plan}">
                    <!-- Panel header with title and general date for the final plan -->
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-md-3">
                                <h4 id="planOrExercise">Planvorschau</h4>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanName" onkeypress="return noenter()"
                                       th:value="${plan.name}" disabled/>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanFocus" onkeypress="return noenter()"
                                       th:value="${plan.trainingsFocus}" disabled/>
                            </div>
                            <div class="col-md-3">
                                <input class="form-control" type="text" id="viewPlanTE" onkeypress="return noenter()"
                                       th:value="${plan.numTrainSessions}" disabled/>
                            </div>
                        </div>
                    </div>
                    <!-- Panel body containing 3 example exercises for an example plan -->
                    <div class="panel-body">
                        <div class="col-md-12">
                            <table class="table table-bordered table-condensed detail detailExerciseTable" border="1"
                                   width="100%" th:each="exercise : ${plan.exerciseInstances}"
                                   th:id="${exercise.id}" th:data="${exercise.id}">
                                <colgroup>
                                    <col width="5%">
                                    <col width="15%">
                                    <col width="30%">
                                    <col width="7%">
                                    <col width="23%">
                                    <col width="5%">
                                    <col width="5%">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>Ordnung</th>
                                    <th>Übung</th>
                                    <th>Ausführung</th>
                                    <th>TE</th>
                                    <th>Sätze - Wiederholungen</th>
                                    <th>Tempo</th>
                                    <th>Pause</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td th:text="${exercise.category}">
                                    </td>

                                    <td th:text="${exercise.name}">
                                    </td>
                                    <td>
                                        <nobr th:class="'planTagsClass' + ${exercise.id}"
                                              th:each="tag : ${exercise.tags}" th:data="${tag}">
                                        </nobr>
                                        <div id="tagBlockPlan">
                                            <input type="text" data-role="tagsinput" onkeypress="return noenter()"
                                                   th:id="'tagsPlan' + ${exercise.id}"
                                                   value="" class="form-control tagsPlanInput" disabled>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group"
                                             th:each="sessions, iStat : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${iStat.count}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group">
                                                <nobr th:each="rep : ${sessions.reps}">
                                                    <nobr th:if="${rep} != 0" th:text="${rep} + ' /'"></nobr>
                                                </nobr>
                                            </ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.tempo}"></ul>
                                        </div>
                                    </td>

                                    <td >
                                        <div class="form-group" th:each="sessions : ${exercise.trainingsSessions}">
                                            <ul class="list-group" th:text="${sessions.pauseInSec}"></ul>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>
                    <!-- Panel footer with button to close the modal positioned on the right -->
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-block"
                                        id="editCurrentExercise" data-dismiss="modal"
                                        onclick="editExercise()">
                                    Übung bearbeiten
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block" id="btnCloseModalViewPlan"
                                        data-dismiss="modal">
                                    Schließen
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal to confirm the deletion of the current plan -->
<div class="modal fade" id="confirm_delete">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-body">
            <form th:action="@{/mods/plans/{path}(path=${createDto.getId()})}" th:method="delete" id="formDelete">
                <div class="panel panel-danger">
                    <div class="panel-heading">
                        <h4>Löschen bestätigen</h4>
                    </div>
                    <div class="panel-body">
                        <p style="font-size: 16px">
                            Wollen sie den aktuellen Plan wirklich löschen?
                        </p>
                        <p class="text-danger" style="font-size: 12px">
                            Diese Aktion kann nicht rückgängig gemacht
                            werden!
                        </p>
                    </div>
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-md-1"></div>
                            <div class="col-md-5">
                                <button type="submit"
                                        class="btn btn-danger btn-block">
                                    Löschen
                                </button>
                            </div>
                            <div class="col-md-5">
                                <button type="button"
                                        class="btn btn-default btn-block"
                                        data-dismiss="modal">Abbrechen
                                </button>
                            </div>
                            <div class="col-md-1"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal to ask if the plan should be converted to a single day plan -->
<div class="modal fade" id="modalConvertPlan">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h4>Konvertieren des Plans zu einem Eintagesplan</h4>
                    </div>
                    <!-- Panel body the option to converted the plan to a single day plan -->
                    <div class="panel-body">
                        <!-- question if the plan should be converted to a single day plan -->
                        <p style="font-size: 16px">
                            Sie haben die Anzahl an Trainingseinheiten für diese Planvorlage auf 1 gesetzt.
                            Möchten sie die Planvorlage in eine Vorlage für einen Eintagesplan umwandeln?
                        </p>
                        <br>
                        <!-- Remark that the changes can be reverted at any time -->
                        <p class="text-muted" style="font-size: 16px">
                            Sie können diese Änderung jederzeit rückgängig machen, indem sie den Haken
                            bei dem Eintagesplan wieder entfernen.
                        </p>
                        <br>
                        <div class="row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-block"
                                        id="buttonConvertPlanToSingleDay" onclick="convertPlanToSingleDay()"
                                        data-dismiss="modal">
                                    Umwandeln
                                </button>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-default btn-block" id="btnCloseModalConvertPlan"
                                        data-dismiss="modal">
                                    Abbrechen
                                </button>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">

    /**
     * Enables the disabled input fields when the request is submitted to send their data too.
     */
    $("form").submit(function() {
        $("input").removeAttr("disabled");
    });

    /**
     * Execute various functions when the page is loaded
     */
    $(document).ready(function(){
        // Open the modal to create a new exercise without the possibility
        // to close the modal by clicking outside of it or esc
        $('.launch-modal').click(function(){
            // launch the modalExerciseForm as static modal to avoid closing by accident
            $('#modalExerciseForm').modal({
                backdrop: 'static'
            });
        });
        // Execute function updateTeInputs when document is loaded
        createTeInputs();
        // Hide the empty display block for the exercise execution tags
        document.getElementById("tagBlock").style.display = "none";
        // Call function to give functionality to the accordion block
        accordionJS();
    });

    function editExercise() {
        var x = document.getElementsByClassName("detailExerciseTable");
        for (i = 0; i < x.length; i++) {
            var y = document.getElementById(x[i].id);
            if (y.style.getPropertyValue("display") === "block"){
                location.href = "/mods/editplan/1/"+x[i].getAttribute('data');
            }
        }
    }

    /**
     * Sets the tags for the plan in it's detailed preview.
     */
    function setPlanTags(value) {
        var x = document.getElementsByClassName("planTagsClass" + value);
        var i;
        for (i = 0; i < x.length; i++) {
            var e = x[i].getAttribute('data');
            $('#tagsPlan' + value).tagsinput('add', e);
            $('#tagsPlanEx' + value).tagsinput('add', e);
        }
    }

    /**
     * Set tags in the tag-input field "tags" to the colorset "warning" (yellow)
     */
    $('.tagsPlanInput').tagsinput({
        tagClass: 'label label-warning'
    });


    /**
     * Script to show details of one exercise. The value specifies the id
     * of the exercise instance.
     */
    function updateDetails(value) {
        var x = document.getElementsByClassName("detailExerciseTable");
        var i;

        if (value === "previewPlan") {
            for (i = 0; i < x.length; i++) {
                var y = document.getElementById(x[i].id);
                y.style.display = "block";
            }
            setPlanTags(value);
            document.getElementById("planOrExercise").innerText = "Planvorschau";
            document.getElementById("editCurrentExercise").style.display = "none";
        } else {
            for (i = 0; i < x.length; i++) {
                var y = document.getElementById(x[i].id);
                if (y.id === value) {
                    y.style.display = "block";
                } else {
                    y.style.display = "none";
                }
            }
            var z = document.getElementsByClassName("detailChangeExerciseTable");
            for (i = 0; i < z.length; i++) {
                var o = document.getElementById(z[i].id);
                if (o.id === 'ExID'+value) {
                    o.style.display = "block";
                } else {
                    o.style.display = "none";
                }
            }
            setPlanTags(value);
            document.getElementById("planOrExercise").innerText = "Übungsdetails";
            document.getElementById("editCurrentExercise").style.display = "block";
        }
        $(document).ready(function () {
            $('#modalViewFinalPlan').modal({
                backdrop: 'static'
            });
        });
    }

    /**
     * Function to hide the div block containing the tag-input field "tags" if there are no tags in it
     */
    $('#tags').on('itemRemoved', function() {
        // Check if the tag-input field "tags" is empty
        if (document.getElementById("tags").value.length == 0) {
            // Hide div block containing tag-input field "tags"
            document.getElementById("tagBlock").style.display = "none";
        }
    });

    /**
     * Function to set the the initial focus on the input field "inputExecutionName" when
     * opening the modal "modalExecutionForm"
     */
    $('#modalExecutionForm').on('shown.bs.modal', function () {
        $('#inputExecutionName').focus();
    });

    /**
     * Function to add a new Tag to the tag-input field "tags"
     */
    function addTag() {
        // Get the name of the new tag from the input field "inputExecution"
        var newTag = document.getElementById("inputExecution").value;
        // Add the stored tag to the tag-input field "tags"
        $('#tags').tagsinput('add', newTag);
        // Reset the input field "inputExecution"
        $('#inputExecution').val('');
        // Show the block containing the tag-input field and the caption
        document.getElementById("tagBlock").style.display = "block";
    }

    /**
     * Function to create a new type of execution to choose from in the datalist "storedExecutions"
     */
    function createExecution() {
        // Get the name of the new execution from the input field "inputExecutionName"
        var newExecution = document.getElementById("inputExecutionName").value;
        // Create a new option with the stored execution name in the datalist "storedEcexutions
        $('#storedExecutions').append(
            '<option value="'+newExecution+'" />'
        );
        // Reset the input field
        $('#inputExecutionName').val('');
    }

    /**
     * Function to add functionality to each accordion block
     */
    function accordionJS() {
        // Get all accordion blocks
        var accordion = document.getElementsByClassName("accordion");
        // Loop to add event-listener to each accordion
        for (var i = 0; i < accordion.length; i++) {
            // Add event-listener for click to current accordion
            accordion[i].addEventListener("click", function() {
                // Toggle the accordion if clicked
                this.classList.toggle("active");
                // Get following accodion-panel
                var accordionPanel = this.nextElementSibling;
                // Avoid overlap of accordion-panels
                if (accordionPanel.style.maxHeight){
                    accordionPanel.style.maxHeight = null;
                } else {
                    accordionPanel.style.maxHeight = accordionPanel.scrollHeight + "px";
                }
            });
        }
    }

    /**
     * Function to add an exercise to the final plan. After adding the exercise it calls
     * the function resetForm() to reset the input fields and calls the function checkPlanEmpty().
     */
    function addExerciseToPlan(){
        // Get the entered values of the exercise form
        var newExerciseOrder = $('#inputOrder').val();
        var newExerciseName = $('#inputExercise').val();
        // Create new list element in final plan containing the entered values and a button to view details
        $('#planExerciseOrder').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<input type="text" value="'+newExerciseOrder+'" class="form-control" disabled onkeypress="return noenter()">' + '</li>');
        $('#planExerciseName').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<input type="text" value="'+newExerciseName+'" class="form-control" disabled onkeypress="return noenter()">' + '</li>');
        $('#planButtonExerciseDetails').append(
            '<li style="padding-top: .3em; padding-bottom: .3em">' +
            '<button type="button" class="btn btn-primary btn-block" data-toggle="modal" ' +
            'data-target="#modalDetailsExercise" onclick="getExerciseDetails()">' +
            '<span class="glyphicon glyphicon-zoom-in"></span>' + ' Details' + '</button>' + '</li>');
        // Reset the exercise form after adding the contents to the final plan
        resetForm();
        // Call checkPlanEmpty to disable the TE buttons after adding an element with fixed TE
        checkPlanEmpty();
    }

    /**
     * Temporary function to delete all elements in the final plan
     * and call the function checkPlanEmpty() to the button savePlan
     */
    function resetPlan() {
        // Create a reference on the lists in the final plan
        var addedOrders = document.getElementById("planExerciseOrder");
        var addedExercises = document.getElementById("planExerciseName");
        var addedDetailButtons = document.getElementById("planButtonExerciseDetails");
        // Remove all list elements in the final plan
        while (addedOrders.hasChildNodes()) {
            addedOrders.removeChild(addedOrders.lastChild);
        }
        while (addedExercises.hasChildNodes()) {
            addedExercises.removeChild(addedExercises.lastChild);
        }
        while (addedDetailButtons.hasChildNodes()) {
            addedDetailButtons.removeChild(addedDetailButtons.lastChild);
        }
        // call checkPlanEmpty to reset the TE buttons
        checkPlanEmpty()
    }


    /**
     * Function to be executed when the checkbox for a single day plan is checked.
     * It sets the TE to 1 and disables the TE-buttons
     */
    function checkboxChanged() {
        if($('#singleDayCheck').prop('checked')) {
            // Get the previous amount of TE´s
            var prevTEs = parseInt(document.getElementById("inputUnit").value);
            // Store the previous amount of TE´s in a hidden input field
            $('#prevUnitAmount').val(prevTEs);
            // Set TE amount to 1
            $('#inputUnit').val(1);
            // Update the input fields according to the new TE amount
            for (var i = 0; i < (prevTEs-1); i++) {
                decreaseTeInputs();
            }
            // Disable the TE-buttons
            $('#btnDecrementTEs').prop('disabled', true);
            $('#btnIncrementTEs').prop('disabled', true);
            // Disable the TE per Week buttons
            $('#btnDecrementWeeklyTes').prop('disabled', true);
            $('#btnIncrementWeeklyTes').prop('disabled', true);
            // Hide the value of training units per week
            document.getElementById("inputUnitsPerWeek").style.color = "white";
        } else {
            // Get the previous amount of TE´s
            var prevTEs = parseInt(document.getElementById("prevUnitAmount").value);
            // Set TE amount to the previous value before setting it to 1
            $('#inputUnit').val(prevTEs);
            // Update the input fields according to the new TE amount
            addMultipleTeInputs(prevTEs);
            // Enable the TE-buttons
            $('#btnDecrementTEs').prop('disabled', false);
            $('#btnIncrementTEs').prop('disabled', false);
            // Enable the TE per Week buttons
            $('#btnDecrementWeeklyTes').prop('disabled', false);
            $('#btnIncrementWeeklyTes').prop('disabled', false);
            // Show the value of training units per week
            document.getElementById("inputUnitsPerWeek").style.color = "black";
        }
    }

    /**
     * Function to check the checkbox for a single day if the user confirms the conversion
     * of the plan in the responsible modal
     */
    function convertPlanToSingleDay() {
        // Set the checked value of the checkbox to true
        $("#singleDayCheck").prop("checked", true);
        // Execute the function checkboxChanged to perform the action associated with the checkbox
        checkboxChanged();
    }

    /**
     * Creates new fields when loading the page for table inputs to customize an exercise
     * according to the amount of preloaded TE´s
     */
    function createTeInputs() {
        // Get the amount of TE´s
        var number = document.getElementById("inputUnit").value;

        // loop to add input fields to the TE/Weights/Repeats/Tempo/Pause columns in the exercise form
        for (var i = 0; i < number; i++){
            // create unique id´s
            var counterTEId = "counter" + i;
            var weightsInputId = "weightsInput" + i;
            var repsInputId = "repsInput" + i;
            var tempoInputId = "tempoInput" + i;
            var pauseInputId = "pauseInput" + i;

            // Add the input fields to the lists
            $('#counterTE').append(
                '<li>' + '<input id="'+counterTEId+'" disabled value="'+(i+1)+'" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#weightsInputs').append(
                '<li>' + '<input id="'+weightsInputId+'" name="weightDiff" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#repsInputs').append(
                '<li>' + '<input id="'+repsInputId+'" name="sets" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#tempoInputs').append(
                '<li>' + '<input id="' + tempoInputId + '" name="tempo" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#pauseInputs').append(
                '<li>' + '<input id="' + pauseInputId + '" name="pause" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        }
    }

    /**
     * Deletes the last input fields in the exercise after the amount of TE´s have been decreased
     */
    function decreaseTeInputs() {
        // Get data lists and store them in variables for further manipulation
        var te = document.getElementById("counterTE");
        var weights = document.getElementById("weightsInputs");
        var reps = document.getElementById("repsInputs");
        var tempos = document.getElementById("tempoInputs");
        var pauses = document.getElementById("pauseInputs");

        // Remove the last input fields in the exercise form
        te.removeChild(te.lastChild);
        weights.removeChild(weights.lastChild);
        reps.removeChild(reps.lastChild);
        tempos.removeChild(tempos.lastChild);
        pauses.removeChild(pauses.lastChild);
    }

    /**
     * Creates an additional set of input fields in the exercise after the amount of
     * TE´s have been increased
     */
    function increaseTeInputs() {
        // Get amount of TE´s
        var currentTE = document.getElementById("inputUnit").value;
        // Get the next ID in the order for the new input fields
        var nextID = parseInt(currentTE) - 1;

        // Add an additional input fields to the TE/Weights/Repeats/Tempo/Pause columns in the exercise form
        var counterTEId = "counter" + nextID;
        var weightsInputId = "weightsInput" + nextID;
        var repsInputId = "repsInput" + nextID;
        var tempoInputId = "tempoInput" + nextID;
        var pauseInputId = "pauseInput" + nextID;

        // Add the input fields to the lists
        $('#counterTE').append(
            '<li>' + '<input id="'+counterTEId+'" disabled value="'+currentTE+'" class="form-control" onkeypress="return noenter()">' + '</li>');
        $('#weightsInputs').append(
            '<li>' + '<input id="'+weightsInputId+'" name="weightDiff" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        $('#repsInputs').append(
            '<li>' + '<input id="'+repsInputId+'" name="sets" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        $('#tempoInputs').append(
            '<li>' + '<input id="' + tempoInputId + '" name="tempo" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        $('#pauseInputs').append(
            '<li>' + '<input id="' + pauseInputId + '" name="pause" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
    }

    /**
     * Creates multiple additional sets of input fields in the exercise after the checkbox for a single
     * day plan has been unchecked
     */
    function addMultipleTeInputs(amountTEs) {
        // loop to add the input fields to the TE/Weights/Repeats/Tempo/Pause columns in the exercise form
        for (var i = 1; i < amountTEs; i++){
            // create unique id´s
            var counterTEId = "counter" + i;
            var weightsInputId = "weightsInput" + i;
            var repsInputId = "repsInput" + i;
            var tempoInputId = "tempoInput" + i;
            var pauseInputId = "pauseInput" + i;

            // Add the input fields to the lists
            $('#counterTE').append(
                '<li>' + '<input id="'+counterTEId+'" disabled value="'+(i+1)+'" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#weightsInputs').append(
                '<li>' + '<input id="'+weightsInputId+'" name="weightDiff" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#repsInputs').append(
                '<li>' + '<input id="'+repsInputId+'" name="sets" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#tempoInputs').append(
                '<li>' + '<input id="' + tempoInputId + '" name="tempo" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#pauseInputs').append(
                '<li>' + '<input id="' + pauseInputId + '" name="pause" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        }
    }

    /**
     * Function to check if the final plan contains exercises.
     * If yes: disable the buttons to change the TE-amount
     * If not: enable the buttons to change the TE-amount
     */
    function checkPlanEmpty() {
        // Get amount of TE´s
        var addedExercises = document.getElementById("planExerciseName");
        // Check if the final plan has contains exercises
        if (addedExercises.hasChildNodes()) {
            // Disable the TE buttons
            $('#btnDecrement').prop('disabled', true);
            $('#btnIncrement').prop('disabled', true);
            // Disable the single day checkbox
            $('#singleDayCheck').prop('disabled', true);
        } else {
            // Enable the TE buttons
            $('#btnDecrement').prop('disabled', false);
            $('#btnIncrement').prop('disabled', false);
            // Enable the single day checkbox
            $('#singleDayCheck').prop('disabled', false)
        }
    }

    /**
     * Function to reset the input form for an exercise to add to the plan
     */
    function resetForm() {
        // Get amount of TE´s
        var number = document.getElementById("inputUnit").value;
        // Empty the content of the input fields
        $('#inputExercise').val('');
        $('#inputOrder').val('');
        $('#inputRM').val('');
        $('#inputExecution').val('');

        // Loop to empty the dynamically created input fields
        for (var i=0;i<number;i++){
            var currentWeightsInput = "#weightsInput" + i;
            var currentRepsInput = "#repsInput" + i;
            var currentTempoInput = "#tempoInput" + i;
            var currentPauseInput = "#pauseInput" + i;
            $(currentWeightsInput).val('');
            $(currentRepsInput).val('');
            $(currentTempoInput).val('');
            $(currentPauseInput).val('');
        }

        $('#tags').tagsinput('removeAll');
        document.getElementById("tagBlock").style.display = "none";
    }

    /**
     * Function to increase the TE-counter and alert if TE climbs over 15
     */
    function incrementTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnit").value;
        // Test if the top limit is reached
        if (oldValue < 15) {
            // Increase the value by 1
            var newValue = parseFloat(oldValue) + 1;
            increaseTeInputs()
        } else {
            // Alert to inform the user that the top limit is reached
            alert("Ein Trainingsplan kann nicht aus mehr als 15 Trainingseinheiten bestehen");
            var newValue = 15;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnit").value = newValue;
    }

    /**
     * Function to decrease the TE-counter and alert if TE falls under 3
     */
    function decrementTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnit").value;
        // Test if the bottom limit is reached
        if (oldValue > 1) {
            // Decrease the value by 1
            var newValue = parseFloat(oldValue) - 1;
            // Check if the TE amount has been reduced to 1
            if (newValue == 1) {
                // Open modal to ask if the editor wants to convert the plan to a single day plan
                $('#modalConvertPlan').modal({});
            }
            decreaseTeInputs()
        } else {
            // Alert to inform the user that the bottom limit is reached
            alert("Ein Trainingsplan kann nicht aus weniger als einer Trainingseinheit bestehen");
            var newValue = 1;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnit").value = newValue;
    }

    /**
     * Function to increase the amount of TEs per week and alert if amount climbs over 7
     */
    function incrementWeeklyTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnitsPerWeek").value;
        // Test if the top limit is reached
        if (oldValue < 7) {
            // Increase the value by 1
            var newValue = parseFloat(oldValue) + 1;
        } else {
            // Alert to inform the user that the top limit is reached
            alert("Ein Trainingsplan kann nicht mehr Trainigseinheiten pro Woche haben als die Woche Tage hat");
            var newValue = 7;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnitsPerWeek").value = newValue;
    }

    /**
     * Function to decrease the amount of TEs per week and alert if amount decreases below 1
     */
    function decrementWeeklyTEs() {
        // Get the current amount of TE´s
        var oldValue = document.getElementById("inputUnitsPerWeek").value;
        // Test if the bottom limit is reached
        if (oldValue > 1) {
            // Decrease the value by 1
            var newValue = parseFloat(oldValue) - 1;
        } else {
            // Alert to inform the user that the bottom limit is reached
            alert("Ein Trainingsplan ist nicht regelmäßig, wenn er weniger als eine Trainingseinheit pro Woche vorsieht");
            var newValue = 1;
        }
        // Write new TE amount in the input field
        document.getElementById("inputUnitsPerWeek").value = newValue;
    }

    /**
     * Temporary function to add example-content to modal to view exercise details
     */
    function getExerciseDetails() {
        // Get amount of TE´s
        var number = document.getElementById("inputUnit").value;

        // Get data lists and store them in variables for further manipulation
        var te = document.getElementById("viewCounterTE");
        var reps = document.getElementById("viewRepsInputs");
        var tempos = document.getElementById("viewTempoInputs");
        var pauses = document.getElementById("viewPauseInputs");

        // loops to reset the example data in the viewExercise table
        while (te.hasChildNodes()) {
            te.removeChild(te.lastChild);
        }
        while (reps.hasChildNodes()) {
            reps.removeChild(reps.lastChild);
        }
        while (tempos.hasChildNodes()) {
            tempos.removeChild(tempos.lastChild);
        }
        while (pauses.hasChildNodes()) {
            pauses.removeChild(pauses.lastChild);
        }

        // loop to add example values to the TE/Repeats/Tempo/Pause columns in viewExercise table
        for (var i=0;i<number;i++){
            // create unique id´s
            var counterTEId = "viewCounter" + i;
            var repsInputId = "viewRepsInput" + i;
            var tempoInputId = "viewTempoInput" + i;
            var pauseInputId = "viewPauseInput" + i;

            // Add the examples to the lists
            $('#viewCounterTE').append(
                '<li>' + '<input id="'+counterTEId+'" disabled value="'+(i+1)+'" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#viewRepsInputs').append(
                '<li>' + '<input id="'+repsInputId+'" disabled value="3 - '+(10+i)+'" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#viewTempoInputs').append(
                '<li>' + '<input id="'+tempoInputId+'" disabled value="90" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
            $('#viewPauseInputs').append(
                '<li>' + '<input id="'+pauseInputId+'" disabled value="60" type="text" class="form-control" onkeypress="return noenter()">' + '</li>');
        }
    }
</script>


<!--- Form value checks--->
<script>
    /**
     * Tests the value in the input field on Null or empty
     * @param id the id of the input field checked witht his method
     * @return if the value passes the evaluation
     */
    function checkNotEmpty(id) {
        var passesTest = true;
        console.log(id);
        var valueInField = document.getElementById(id).value;
        console.log(valueInField);
        if (valueInField == null || valueInField == "") {
            console.log(id + " :checkNotEmpty : failed");
            document.getElementById(id).style.borderColor = "red";
            passesTest = false;
        } else{
            console.log(id + " :checkNotEmpty : passed");
            document.getElementById(id).style.borderColor = "#CCCCCC";
        }
        return passesTest;
    }

    /**
     * Tests the value in the input field on Null, empty or special characters
     * @param id the id of the input field checked witht his method
     * @return if the value passes the evaluation
     */
    function checkSpecialCharacters(id){
        var passesTest = checkNotEmpty(id);
        var valueInField = document.getElementById(id).value;
        console.log(id + " :checkSpcialCharaters : value : " + valueInField);
        var format = /[ !@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/;
        if (format.test(valueInField)){
            passesTest = false;
            console.log(id + " :checkSpcialCharaters : failed");
            document.getElementById(id).style.borderColor = "red";
        } else{
            document.getElementById(id).style.borderColor = "#CCCCCC";
        }
        return passesTest;
    }

    /**
     * Tests the value in the input on if it only has Letters from a-Z
     * @param id the id of the input field checked witht his method
     * @return if the value passes the evaluation
     */
    function checkText(id){
        if (checkSpecialCharacters(id)) {
            var format = /^[a-zäöüA-ZÄÄÖÜ ]+$/
            var valueInField = document.getElementById(id).value;
            var passesTest =  format.test(valueInField);
            if (passesTest){
                console.log(id + " :checkText : passed");
                document.getElementById(id).style.borderColor = "#CCCCCC";
                return true;
            }
        }
        console.log(id + " :checkText : failed");
        document.getElementById(id).style.borderColor = "red";
        return false;
    }

    /**
     * Tests the value in the input field on if it is a Number
     * @param id the id of the input field checked witht his method
     * @return if the value passes the evaluation
     */
    function checkNumber(id) {
        if (checkNotEmpty(id)) {
            var valueInField = document.getElementById(id).value;
            if (!isNaN(valueInField)){
                console.log(id + " :checkNumber : passed");
                document.getElementById(id).style.borderColor = "#CCCCCC";
                return true;
            }
        }
        console.log(id + " :checkNumber : failed");
        document.getElementById(id).style.borderColor = "red";
        return false;
    }

    /**
     * Tests the value in the weight/rep fields
     * @param id the id of the input field checked witht his method
     * @return if the value passes the evaluation
     */
    function checkNumberAndStroke(id){
            var format = /^[0-9/+-]*$/
            var valueInField = document.getElementById(id).value;
            var passesTest =  format.test(valueInField);
            if (passesTest){
                console.log(id + " :checkText : passed");
                document.getElementById(id).style.borderColor = "#CCCCCC";
                return true;
            }
        console.log(id + " :checkText : failed");
        document.getElementById(id).style.borderColor = "red";
        return false;
    }

    /**
     * Counts if an exercise has more than 10 sets
     * */
    function countAmountOfSets(id) {
        var content = document.getElementById(id).value;
        var amountOfSlashes = (content.match(/\//g) || []).length;
        if (amountOfSlashes < 10){
            return true;
        }
        return false;
    }

    /**
     * Checks if a plan with the same name already exists
     * */
    function checkNoDuplicatePlanName(){
        //TODO add listLength
        var listLength;
        var passesTest = true
        if(document.getElementById("planID").value != null){
            return passesTest
        }
        for (var i = 0; i < listLength; i++){
            /**TODO compare to list of existing names
            if (document.getElementById("planName").value == [POINT TO THE LIST @ I]){
                passesTest = false;
                alert("Dieser Name ist bereits für einen Plan vergeben. Bitte wähle einen anderen.")
            }*/
        }
        return passesTest;

    }

    /**
     * Checks if the execution field has the right format if the "add" or Speichern button is pressed.
     */
    function checkExecution() {
        var id = "inputExecution";
        console.log(document.getElementById(id).value +" : THis value should be whatever was typed in and not Null");
        if(checkNotEmpty(id)){
            addTag();
            console.log("CheckText : Test was passed ");
        } else{
            console.log("CheckText : Test was failed");
            alert("Bitte stell sicher, dass keine Sonderzeichen und Ziffern" +
                " verwendet werden");
        }
    }

    /**
     * Checks if the create new execution field has the correct format
     */
    function checkExecutionAdd() {
        var id = "inputExecutionName";
        console.log("checkExecutionName: " + id);
        if(checkNotEmpty(id)){
            createExecution();
        } else{
            alert("Bitte stell sicher, dass keine Sonderzeichen und Ziffern" +
                " verwendet werden");
        }
    }

    /**
     * Checks if the forms are filled out before adding exercise
     *
    function addNewExerciseCheck() {
        var weightType = document.getElementById('weightType').value;
        console.log(weightType);
        if (weightType == "Wähle eine Option aus...") {
            alert("Bitte wähle eine Gewichtsart");
        } else{
            if(checkText('exerciseName')&& checkNotEmpty('exercise_description')){
                console.log("Exercise would be saved.")
                // press button, once it has function
            } else{
                alert("Eine Übung braucht mindestens einen Namen, eine Beschreibung und eine Gewichtsart. Sonderzeichen sind nicht möglich.")
            }
        }
    }
    */



    /**
     * Checks if the exercise fullfills the requirements if the "Übung zum Plan hinzufügen"-button is pressed
     */
    function checkExercise() {
        var passesTest = true;
        var alertmessage = "";
        if (!allTEFilled() ) {
            passesTest = false;
            alertmessage = "Bitte stelle sicher, dass keine der Felder für die Übung leer sind und du dem gegebenen Format folgst. ";
        }
        if (!checkNotEmpty("planName")) {
            passesTest = false;
            alertmessage = alertmessage + "Bitte benenne deinen Plan, bevor due eine Übung einfügst. ";
        }
        if (!checkNotEmpty("inputExercise")) {
            passesTest = false;
            alertmessage = alertmessage + "Der Übungsname kann nur aus Buchstaben bestehen. ";
        }
        if (!checkNotEmpty("inputOrder")||!checkSpecialCharacters("inputOrder")) {
            passesTest = false;
            alertmessage = alertmessage + "In der Ordnung sind Sonderzeichen nicht erlaubt. ";
        }
        if (!checkNumber("inputRM")) {
            passesTest = false;
            alertmessage = alertmessage + "RM muss eine Zahl sein. ";
        }
        if (passesTest) {
            document.getElementById('buttonAddExerciseClick').click();
        } else {
            alert(alertmessage);
        }
    }

    /**
     * Checks if all Fields for the exercise are filled.
     * Every if has to be checked seperate, so the Border outlines get coloured in every column, as "and" stops testings as soon as one returns false.
     * @return boolean 'passesTest'
     */
    function allTEFilled() {
        var passesTest = true;
        console.log("TE check start");
        var units = document.getElementById('inputUnit').value;
        for (var i = 0; i < units; i++){
            var weightfield = "weightsInput" + i;
            var repfield = "repsInput" + i;
            var tempofield = "tempoInput" + i;
            var pausefield = "pauseInput" + i;
            if (!checkNumberAndStroke(weightfield) || countAmountOfSets(weightfield)){

                passesTest = false;
            }
            if (!checkNumberAndStroke(repfield) || !checkNotEmpty(repfield) || countAmountOfSets(repfield)){
                passesTest = false;
            }
            if (!checkNotEmpty(tempofield)){
                passesTest = false;
            }
            if (!checkNumber(pausefield)){
                passesTest = false;
            }
        }
        console.log("TE check passed");
        if (!checkNoDuplicatePlanName()){
            passesTest = false;
        }
        return passesTest;
    }

    function checkPlan() {
        var alertmessage = "";
        var focus = document.getElementById('focus').value;
        var targetGroup = document.getElementById('targetGroup').value;
        console.log("0");
        var focusBool = true;
        var targetGroupBool = true;

        if(focus == "Wähle eine Option aus..."){
            focusBool = false;
            alertmessage = "Ziel wird benötigt;";
        }
        console.log("1"+focusBool);

        if(targetGroup == "Wähle eine Option aus..."){
            targetGroupBool = false;
            alertmessage = alertmessage + " Zielgruppe wird benötigt;";
        }
        console.log("2"+targetGroupBool);

        if (checkNumber("inputUnit") && checkNumber("inputUnitsPerWeek") && focusBool && targetGroupBool){
            console.log("plan passed");
            confirmPlan();
        } else {
            console.log("plan failed");
            alert(alertmessage + " Bitte stell sicher, dass keine Felder leer sind und keine " +
                "Sonderzeichen außer bei Gewicht/Wiederholungen verwendet werden");
        }
    }

    /**
     * Function to validate if confirming a plan is possible.
     * It shows an error message if the plan is empty and submits a form to confirm the plan otherwise.
     */
    function confirmPlan() {
        var x = document.getElementById("detailsExercises");
        if(x === null) {
            document.getElementById("errorConfirm").style.display = "block";
            $('html, body').animate({ scrollTop: 0}, 'slow');
        } else {
            document.getElementById("confirmPlan").submit();
        }
    }

</script>

</body>
</html>