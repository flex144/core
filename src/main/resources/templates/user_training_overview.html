<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Your personalized training page</title>
    <link rel="stylesheet"
          href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
          integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <style>

        html, body {
            width: 100%;
            height: 100%;
        }

        .highlightedContainer {
            background: #fd8900; /*light orange*/
            border: 2px solid #2E2E2E;
            display: flex;
            align-items: center;
            text-align: center;
            width: 100%;
            height: 100%;
        }

        .fullsize{
            width: 100%;
            height: 100%;
            text-align: center;
        }

        .containerColor{
            background: #ecf0f1;
            border: solid 2px #2E2E2E;
        }

        .tableCentered{
            height: 100%;
            width: 15%;
            margin-top: 15px;
        }
    </style>
</head>
<body>

<!--- Exercise Hint Modal --->
<div id="exerciseModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="container">
                    <div class="jumbotron">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                Name:
                            </div>
                            <div class="panel-body">
                                <p></p>
                            </div>
                        </div>
                        <div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    Beschreibung:
                                </div>
                                <div class="panel-body">
                                    <p ></p>
                                </div>
                            </div>
                            <div class="panel panel-default" >
                                <div class="panel-heading">
                                    Beispielvideo:
                                </div>
                                <div class="panel-body">
                                    <div class="embed-responsive embed-responsive-16by9">
                                        <iframe  width="560" height="315"
                                                 frameborder="0" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <p>
                                        Muskelgruppen Bilder:</p>
                                </div>
                                <div class="panel-body">

                                    <div
                                            class="image">
                                        <img/>
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default" >
                                <div class="panel-heading">
                                    <p>Andere
                                        Bilder:</p>
                                </div>
                                <div class="panel-body">
                                    <div
                                            class="image">
                                        <img/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container" id="toggledAlert" >
                <div class="container">
                    <h5 style="color: red; text-align: center; background: #e3f2fd; border: 1px solid black;">
                        Es ist nicht empfohlen die alternativen Übungen zu wählen.
                        Wenn die Entscheidung aus gesundheitlichen Gründen folgt,
                        so kontaktieren sie einen Trainer.
                    </h5>
                    <div class="row">
                        <div class="container" style="width: 80%">
                            <div class="form-group">
                                <select id="weightType" class="form-control">
                                    <option>Diese Übung</option>
                                    <option>Alternative Xyz</option>
                                </select>
                            </div>
                        </div>
                        <button type="button" style="width: 20%"
                                class="btn btn-secondary" onclick="enableSave()">
                            Ok
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="container">
                    <button type="button"
                            class="btn btn-block btn-success" style="font-size: small" onclick="safeAlternativeExercise()" disabled id="button_saveExercise">
                        Übung festlegen
                    </button>
                    <button type="button"
                            class="btn btn-block btn-warning" data-toggle="button" aria-pressed="false" style="font-size: small" onclick="toggleExercise()">
                        Alternative
                    </button>
                    <button type="button"
                            class="btn btn-block btn-danger" data-dismiss="modal" style="font-size: small" id="closeInfoModal">
                        Zurück
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--- Modal containing general Information --->
<div id="infoModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="jumbotron" style="text-align: center;">
                    <h4>Es ist empfohlen dem Plan möglichst präzise zu folgen.</h4>
                    <h6>Nur durch richtige Ausführung der Übungen, mit guter Form und empfohlenen Anzahlen/Gewichten wird guter Vortschritt erreicht.</h6>
                    <h6>Übungen in der selben Farbe sind in einem sogennanten 'Super Set'.</h6>
                    <h6>Übungen in einem Superset sollten abgeschlossen werden, bevor das nächste Superset begonnen wird.</h6>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button"
                        class="btn btn-block btn-warning" data-dismiss="modal" id="leaveInfoModal">
                    Zurück
                </button>
            </div>
        </div>
    </div>
</div>

<!--- Modal used to warn user before leaving the training --->
<div id="exitModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="jumbotron" style="text-align: center;">
                    <h4>Training wirklich abbrechen?</h4>
                </div>
                <button type="button"
                        class="btn btn-block btn-secondary" data-dismiss="modal" id="buttonContinue">
                    Fortsetzen
                </button>
                <div class="modal-footer">
                    <a type="button"
                            class="btn btn-block btn-danger" th:href="@{/user/home}">
                        Training abbrechen
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!--- Modal used to warn user before choosing new superset --->
<div id="supersetModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="jumbotron" style="text-align: center;">
                    <h4>Übungen im selben Satz sollten gemeinsam abgeschlossen werden. Trotzdem neuen Supersatz beginnen?</h4>
                </div>
                <button type="button"
                        class="btn btn-block btn-secondary" data-dismiss="modal">
                    Im Set bleiben
                </button>
                <div class="modal-footer">
                    <button type="button"
                       class="btn btn-block btn-danger" onclick="newSuperset()">
                        Neues set
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--- Page Header --->
<!--- TODO Thymeleaf load #TE --->
<div class="highlightedContainer" id="container_header"
     style="height: 10%;">
    <div style="width: 70%;">
        <!---th:text=--->
        <h3>Trainingsplan nr. </h3>
    </div>
    <div style="width: 10%;">
        <div style="font-size: smaller; height: 20%">set:</div>
        <div style="height: 80%">
            <h4><span id="currentOrder" ></span></h4>
        </div>
    </div>
    <div style="width: 5%"></div>
    <button data-toggle="modal" data-target="#infoModal" class="btn btn-info" id="openInfoModal">
        i
    </button>
</div>


<!---
    TODO thymeleaf Each Container has to execute
    "thymeleafColourCoding(orderValue, idValue)"
    with orderValue being e.g. 'A1'
    and idValue being the thymeleafID of this element
    TODO thymeleaf call clickedOnExercise() onClick
--->
<!--- Template for thymeleaf data to load into --->
<div class="container" id="container_content" style="height: 70%;
        overflow-x: fragments; overflow-y: scroll; text-align: center;
        padding: 5px">
    <div class="container" style="padding-bottom: 2px; height: 15%" id="exercise">
        <!---  th:each th:onclick="" th:id= --->
        <!--- TODO thymeleaf remove test class after it is implemented--->
        <div class="containerColor fullsize farbTest1" >
            <table class="fullsize" id="table" >
                <tr class="fullsize" style="display: flex" id="row">
                    <!--- TODO Session save Status --->
                    <td class="tableCentered" >
                            <label class="btn active">
                                <input type="checkbox" name="" id=""
                                       autocomplete="off" disabled style="transform: scale(2)">
                            </label>
                    </td>
                    <td class="tableCentered" id="column" onclick="clickedOnExercise()">
                        <!--- TODO thymeleaf remove test class after implementation--->
                        <!--- th:text th:id--->
                        <h3 class="numbertest1" id="orderNumber">A1</h3>
                    </td>
                    <td class="tableCentered" style="width: 50%;" onclick="clickedOnExercise()">
                        <!--- th:text--->
                        <h3>Klimmzüge</h3>
                    </td>
                    <td class="tableCentered" style="width: 20%">
                        <!--- TODO Thymeleafe: Button links to exercise description / OR remove --->
                        <button data-toggle="modal" data-target="#exerciseModal" class="btn btn-info" id="infoButton">
                            i
                        </button>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <!--- To showacase colours, delet after funcitonality integrated--->
    <div class="container" style="padding-bottom: 2px; height: 15%">
        <div class="containerColor fullsize farbTest1" >
            <table class="fullsize" >
                <tr class="fullsize" style="display: flex">
                    <td class="tableCentered" >
                        <label class="btn active">
                            <input type="checkbox" name=""
                                   autocomplete="off" disabled style="transform: scale(2)">
                        </label>
                    </td>
                    <td class="tableCentered"onclick="loadExercise()">
                        <h3 class="numbertest1">A2</h3>
                    </td>
                    <td class="tableCentered" style="width: 50%;" onclick="loadExercise()">
                        <h3>Klimmboote</h3>
                    </td>
                    <td class="tableCentered" style="width: 20%">
                        <button data-toggle="modal" data-target="#exerciseModal" class="btn btn-info">
                            i
                        </button>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="container" style="padding-bottom: 2px; height: 15%">
        <div class="containerColor fullsize farbTest2" >
            <table class="fullsize" >
                <tr class="fullsize" style="display: flex">
                    <td class="tableCentered" >
                        <label class="btn active">
                            <input type="checkbox" name=""
                                   autocomplete="off" disabled style="transform: scale(2)">
                        </label>
                    </td>
                    <td class="tableCentered"onclick="loadExercise()">
                        <h3 class="numbertest2">B1</h3>
                    </td>
                    <td class="tableCentered" style="width: 50%;" onclick="loadExercise()">
                        <h3>Handstand</h3>
                    </td>
                    <td class="tableCentered" style="width: 20%">
                        <button data-toggle="modal" data-target="#exerciseModal" class="btn btn-info">
                            i
                        </button>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="container" style="padding-bottom: 2px; height: 15%">
        <div class="containerColor fullsize farbTest3" >
            <table class="fullsize" >
                <tr class="fullsize" style="display: flex">
                    <td class="tableCentered" >
                        <label class="btn active">
                            <input type="checkbox" name=""
                                   autocomplete="off" disabled style="transform: scale(2)">
                        </label>
                    </td>
                    <td class="tableCentered"onclick="loadExercise()">
                        <h3 class="numbertest3">C1</h3>
                    </td>
                    <td class="tableCentered" style="width: 50%;" onclick="loadExercise()">
                        <h3>Tafel putzen</h3>
                    </td>
                    <td class="tableCentered" style="width: 20%">
                        <button data-toggle="modal" data-target="#exerciseModal" class="btn btn-info">
                            i
                        </button>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>


    <!--- Buttons to leave/star the exercise --->
<div class="highlightedContainer" id="container_timer" style="height: 20%;">
    <div class="container fullsize row">
        <div style="width: 50%; height: 100%; padding: 5%;" id="button_trainingBack">
            <button type="button"
                    class="btn btn-block btn-danger fullsize" id="backButton"
                    style="height: 100%; min-height: 50px" th:href="@{/user/home}">
                Zurück
            </button>
        </div>
        <div style="width: 50%; height: 100%; padding: 5%;" id="button_trainingStart">
            <button type="button"
                    class="btn btn-block btn-success fullsize" id="startButton"
                    style="height: 100%; min-height: 50px" onclick="startTraining()">
                Training <br> starten
            </button>
        </div>
        <div style="width: 50%; height: 100%; padding: 5%;" id="button_trainingExit">
            <button type="button"
                    class="btn btn-block btn-danger fullsize"
                    style="height: 100%; min-height: 50px" data-toggle="modal" data-target="#exitModal" id="exitOverview">
                Traing <br> abbrechen
            </button>
        </div>
        <div style="width: 50%; height: 100%; padding: 5%;" id="button_trainingFinished">
            <button type="button"
                    class="btn btn-block btn-success fullsize"
                    style="height: 100%; min-height: 50px" onclick="startTraining()" disabled>
                Abschließen
            </button>
        </div>
    </div>
</div>


<script>
    function loadExercise() {
        window.location = "exercise"
    }
</script>


<!--- Button functionality --->
<script>
    function startTraining(){
        /*TODO maybe enable clicking on exercises*/
        document.getElementById('button_trainingStart').style.display = "none";
        document.getElementById('button_trainingBack').style.display = "none";
        document.getElementById('button_trainingExit').style.display = "inherit";
        document.getElementById('button_trainingFinished').style.display = "inherit";
    }

    /*Sets the order and loads next page*/
    function clickedOnExercise(){
        var currentOrder = document.getElementById("currentOrder").innerHTML;
        var id = this.id;
        var thisExerciseOrder = "orderNumber" + id;
        var clickedOrder = document.getElementById("orderNumber").innerHTML;
        localStorage.setItem("orderValue", currentOrder);
        console.log(currentOrder);
        if ((currentOrder == clickedOrder) || currentOrder == ""){
            console.log("after");
            window.location = "exercise"
            //updateCurrentOrder(id);
        } else{
            $('#noValidInputModule').modal('show');
        }

    }

    function newSuperset(){
        var currentOrder = document.getElementById("orderNumber").innerHTML;
        localStorage.setItem("orderValue", currentOrder);
        //updateCurrentOrder(id);
    }

    /*Set's the Order of the id it's used on*/
    function updateCurrentOrder(id){
        var orderOfExercise = "orderNumber" + id;
        document.getElementById(orderOfExercise).innerHTML;
    }

</script>

<script>

    document.onLoad(initialLoad());
    function initialLoad(){
        warningHidden = true;
        document.getElementById('toggledAlert').style.display = "none";
        document.getElementById('button_saveExercise').style.display = "none";
        document.getElementById('exitButton').style.display = "none";

        var currentOrder = localStorage.getItem("orderValue")
        console.log(currentOrder + "on_load");
        document.getElementById("currentOrder").innerHTML = currentOrder;
    }


    function enableSave(){
        document.getElementById('button_saveExercise').disabled = false;
    }

    function toggleExercise() {
        if (warningHidden){
            warningHidden = false;
            document.getElementById('toggledAlert').style.display = "inherit";
            document.getElementById('button_saveExercise').style.display = "inherit";
        } else{
            warningHidden = true;
            document.getElementById('toggledAlert').style.display = "none";
            document.getElementById('button_saveExercise').style.display = "none";
            document.getElementById('button_saveExercise').disabled = true;
        }
    }
</script>
<!--- Colouring every row --->
<script>
    var numberOfTotalSuperSets = 9;

    document.onLoad(initializeData());
    function initializeData() {
        document.getElementById('button_trainingExit').style.display = "none";
        document.getElementById('button_trainingFinished').style.display = "none";
        for (var i = 0; i < numberOfTotalSuperSets; i++){
            colourCoding(i + 1);
        }
    }

    /*Colours all Elements of the same class in the same Colours*/
    function colourCoding(numberOfThisSuperSet){
        var numbertest = "numbertest" + numberOfThisSuperSet;
        var farbtest = "farbTest" + numberOfThisSuperSet;
        var listOfThisOrder = document.getElementsByClassName(numbertest);
        for (var i = 0; i < listOfThisOrder.length; i++) {
            document.getElementsByClassName(farbtest)[i].style.background = rainbow(numberOfTotalSuperSets,numberOfThisSuperSet);
        }
    }

    /*Colours Elements using Data from thymeleaf*/
    function thymeleafColourCoding(orderValue, idValue){
        var colorDecider = orderValue.charCodeAt(0) - 64;
        document.getElementById(idValue).style.background = rainbow(numberOfTotalSuperSets, colorDecider);
    }

    /*Chooses colours evenly distributed from a spectrum*/
    function rainbow(numOfSteps, step) {
        var r, g, b;
        var h = step / numOfSteps;
        var i = ~~(h * 6);
        var f = h * 6 - i;
        var q = 1 - f;
        switch(i % 6){
            case 0: r = 1; g = f; b = 0; break;
            case 1: r = q; g = 1; b = 0; break;
            case 2: r = 0; g = 1; b = f; break;
            case 3: r = 0; g = q; b = 1; break;
            case 4: r = f; g = 0; b = 1; break;
            case 5: r = 1; g = 0; b = q; break;
        }
        var c = "#" + ("00" + (~ ~(r * 255)).toString(16)).slice(-2) + ("00" + (~ ~(g * 255)).toString(16)).slice(-2) + ("00" + (~ ~(b * 255)).toString(16)).slice(-2);
        return (c);
    }

</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
        integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
</body>
</html>